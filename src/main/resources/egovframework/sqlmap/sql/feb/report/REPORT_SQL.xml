<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="febreport">
	
	<typeAlias alias="ye700ReportVO" type="com.ezsign.feb.report.vo.YE700ReportVO"/>
	<typeAlias alias="inputStatusVO" type="com.ezsign.feb.report.vo.InputStatusVO" />
	<typeAlias alias="itemVO" type="com.ezsign.feb.report.vo.ItemVO" />
	<typeAlias alias="ye003VO" type="com.ezsign.feb.worker.vo.YE003VO" />
	<typeAlias alias="ye402ReportVO" type="com.ezsign.feb.report.vo.YE402ReportVO" />
	<typeAlias alias="ye404ReportVO" type="com.ezsign.feb.report.vo.YE404ReportVO" />
	<typeAlias alias="ye408ReportVO" type="com.ezsign.feb.report.vo.YE408ReportVO" />
	<typeAlias alias="annuitySavingVO" type="com.ezsign.feb.report.vo.AnnuitySavingVO" />
	<typeAlias alias="ye105ReportVO" type="com.ezsign.feb.report.vo.YE105ReportVO" />
	<typeAlias alias="ye101VO" type="com.ezsign.feb.house.vo.YE101VO" />
	<typeAlias alias="ye104VO" type="com.ezsign.feb.house.vo.YE104VO" />
 
	<!-- 요약표 -->
	<select id="reportDAO.getYE700SummaryList" parameterClass="ye700ReportVO" resultClass="ye700ReportVO">
	
		SELECT    
			<![CDATA[   
      			YE000.사업장ID,FN_사업장명(YE000.계약ID, YE000.사업장ID) AS 사업장명,       
      			YE000.부서ID,FN_부서명(YE000.계약ID, YE000.부서ID, YE000.사용자ID) 부서명,       
      			EMP.EMP_NO AS 사번,EMP.EMP_NAME AS 성명,EMP.BIZ_ID AS BIZID,       
      			YE000.개인식별번호,YE000.연말정산분납여부,YE000.계약ID,YE000.사용자ID,       
      			CONCAT(YS000.FEB_YEAR ,'/13') 정산년월,    
      			(CASE              
          			WHEN SUBSTRING(EMP.JOIN_DATE,1,4) = YS000.FEB_YEAR THEN EMP.JOIN_DATE                
          			WHEN SUBSTRING(EMP.JOIN_DATE,1,4) < YS000.FEB_YEAR THEN CONCAT(YS000.FEB_YEAR,'0101')             
       			END) AS 근무시작일,            
      			(CASE               
          			WHEN length(trim(IFNULL(EMP.LEAVE_DATE, ''))) = 0 OR EMP.LEAVE_DATE = '0' THEN CONCAT(YS000.FEB_YEAR, '1231')  
	            	WHEN SUBSTRING(IFNULL(EMP.LEAVE_DATE, ''), 1, 4) > YS000.FEB_YEAR THEN CONCAT(YS000.FEB_YEAR, '1231') 
	            	WHEN SUBSTRING(IFNULL(EMP.LEAVE_DATE, ''), 1, 4) < YS000.FEB_YEAR THEN ''             
          			ELSE EMP.LEAVE_DATE              
       			END) AS 근무종료일,    
       			YE002.현근무지_과세소득,YE002.현근무지_비과세소득,YE002.현근무지_감면소득,
       			YE002.전근무지_과세소득,YE002.전근무지_비과세소득,YE002.전근무지_감면소득,
      			(YE700.주근무지_소득세 + YE700.종근무지_소득세 ) AS 기납부세액_소득세,    
      			(YE700.주근무지_지방소득세 + YE700.종근무지_지방소득세 ) AS 기납부세액_지방소득세,    
      			(YE700.종근무지_농어촌특별세 + YE700.주근무지_농어촌특별세 ) AS 기납부세액_농어촌특별세,   
      			ifnull(YE700.결정세액_소득세,0) AS 결정세액_소득세,    
      			ifnull(YE700.결정세액_지방소득세,0) AS 결정세액_지방소득세,    
      			ifnull(YE700.결정세액_농어촌특별세,0) AS 결정세액_농어촌특별세,    
      			ifnull(YE700.납부특례_소득세,0) AS 납부특례_소득세,    
      			ifnull(YE700.납부특례_지방소득세,0) AS 납부특례_지방소득세,    
      			ifnull(YE700.납부특례_농어촌특별세,0) AS 납부특례_농어촌특별세,    
      			ifnull(YE700.차감징수_소득세,0) AS 차감징수_소득세,    
      			ifnull(YE700.차감징수_지방소득세,0) AS 차감징수_지방소득세,    
      			ifnull(YE700.차감징수_농어촌특별세,0) AS 차감징수_농어촌특별세,
      			(CASE WHEN IFNULL(m1, 'N') = 'Y' THEN (CASE WHEN m1금액 - 200000 < 0 THEN m1금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m2, 'N') = 'Y' THEN (CASE WHEN m2금액 - 200000 < 0 THEN m2금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m3, 'N') = 'Y' THEN (CASE WHEN m3금액 - 200000 < 0 THEN m3금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m4, 'N') = 'Y' THEN (CASE WHEN m4금액 - 200000 < 0 THEN m4금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m5, 'N') = 'Y' THEN (CASE WHEN m5금액 - 200000 < 0 THEN m5금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m6, 'N') = 'Y' THEN (CASE WHEN m6금액 - 200000 < 0 THEN m6금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m7, 'N') = 'Y' THEN (CASE WHEN m7금액 - 200000 < 0 THEN m7금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m8, 'N') = 'Y' THEN (CASE WHEN m8금액 - 200000 < 0 THEN m8금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m9, 'N') = 'Y' THEN (CASE WHEN m9금액 - 200000 < 0 THEN m9금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m10, 'N') = 'Y' THEN (CASE WHEN m10금액 - 200000 < 0 THEN m10금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m11, 'N') = 'Y' THEN (CASE WHEN m11금액 - 200000 < 0 THEN m11금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m12, 'N') = 'Y' THEN (CASE WHEN m12금액 - 200000 < 0 THEN m12금액 ELSE 200000 END) ELSE 0 END) as 차량비과세합계
      		]]>     
		FROM       TBL_YS000 YS000           
			INNER JOIN       TBL_YS030 YS030 
			ON YS000.계약ID = YS030.계약ID  AND YS030.신고대상 = '1' AND YS030.사용여부 = '1'         
			INNER JOIN       TBL_YE000 YE000 
			ON YS030.계약ID = YE000.계약ID AND YS030.사업장ID = YE000.사업장ID AND YE000.사용여부 = '1'
			INNER JOIN       TBL_EMP EMP 
			ON YS000.BIZ_ID = EMP.BIZ_ID  AND EMP.USER_ID = YE000.사용자ID  AND EMP.USE_YN = 'Y'
			INNER JOIN (
    				SELECT
        				계약ID,사용자ID,
        				SUM(현근무지_과세소득) AS 현근무지_과세소득,
        				SUM(현근무지_비과세소득) AS 현근무지_비과세소득,
        				SUM(현근무지_감면소득) AS 현근무지_감면소득,
        				SUM(전근무지_과세소득) AS 전근무지_과세소득,
        				SUM(전근무지_비과세소득) AS 전근무지_비과세소득,
        				SUM(전근무지_감면소득	) AS 전근무지_감면소득
    				FROM(
        				SELECT
            				YE000.계약ID,
            				YE000.사용자ID,
            				(CASE 
                				WHEN YE002.근무지구분 = '1' THEN IFNULL(YE003.급여, 0) + IFNULL(YE003.상여, 0) + IFNULL(YE003.인정상여, 0) + IFNULL(YE003.직무발명보상금, 0)              
                    				+ IFNULL(YE003.주식매수선택권행사이익, 0) + IFNULL(YE003.우리사주조합인출금, 0) + IFNULL(YE003.임원퇴직소득금액한도초과액, 0) 
                				ELSE 0    
             				END) AS 현근무지_과세소득,       
            				(CASE 
               					WHEN YE002.근무지구분 = '1' THEN IFNULL(YE003.M01, 0) + IFNULL(YE003.M02, 0) + IFNULL(YE003.M03, 0) + IFNULL(YE003.O01, 0)               
                    					+ IFNULL(YE003.Q01, 0) + IFNULL(YE003.H08, 0) + IFNULL(YE003.H09, 0) + IFNULL(YE003.H10, 0) + IFNULL(YE003.G01, 0) + IFNULL(YE003.H11, 0) + IFNULL(YE003.H12, 0)               
                    					+ IFNULL(YE003.H13, 0) + IFNULL(YE003.H01, 0) + IFNULL(YE003.K01, 0) + IFNULL(YE003.S01, 0) + IFNULL(YE003.Y02, 0) + IFNULL(YE003.Y03, 0) + IFNULL(YE003.Y04, 0)               
                    					+ IFNULL(YE003.H05, 0) + IFNULL(YE003.I01, 0) + IFNULL(YE003.R10, 0) + IFNULL(YE003.H14, 0) + IFNULL(YE003.H15, 0) + IFNULL(YE003.H16, 0) + IFNULL(YE003.R11, 0)               
                    					+ IFNULL(YE003.H06, 0) + IFNULL(YE003.H07, 0) + IFNULL(YE003.Y22, 0) + IFNULL(YE003.H17, 0) + IFNULL(YE003.U01, 0) 
               					ELSE 0       
             				END) AS 현근무지_비과세소득,    
            				(CASE 
                				WHEN YE002.근무지구분 = '1' THEN IFNULL(YE003.T01, 0) + IFNULL(YE003.T10, 0) + IFNULL(YE003.T11, 0) + IFNULL(YE003.T12, 0) + IFNULL(YE003.T13, 0) + IFNULL(YE003.T20, 0) 
                				ELSE 0
             				END) AS 현근무지_감면소득,       
            				(CASE 
                				WHEN YE002.근무지구분 = '2' THEN IFNULL(YE003.급여, 0) + IFNULL(YE003.상여, 0) + IFNULL(YE003.인정상여, 0) + IFNULL(YE003.직무발명보상금, 0)              
                    				+ IFNULL(YE003.주식매수선택권행사이익, 0) + IFNULL(YE003.우리사주조합인출금, 0) + IFNULL(YE003.임원퇴직소득금액한도초과액, 0) 
                				ELSE 0     
             				END) AS 전근무지_과세소득,       
            				(CASE 
                				WHEN YE002.근무지구분 = '2' THEN IFNULL(YE003.M01, 0) + IFNULL(YE003.M02, 0) + IFNULL(YE003.M03, 0) + IFNULL(YE003.O01, 0)               
                    					+ IFNULL(YE003.Q01, 0) + IFNULL(YE003.H08, 0) + IFNULL(YE003.H09, 0) + IFNULL(YE003.H10, 0) + IFNULL(YE003.G01, 0) + IFNULL(YE003.H11, 0) + IFNULL(YE003.H12, 0)               
                    					+ IFNULL(YE003.H13, 0) + IFNULL(YE003.H01, 0) + IFNULL(YE003.K01, 0) + IFNULL(YE003.S01, 0) + IFNULL(YE003.Y02, 0) + IFNULL(YE003.Y03, 0) + IFNULL(YE003.Y04, 0)               
                    					+ IFNULL(YE003.H05, 0) + IFNULL(YE003.I01, 0) + IFNULL(YE003.R10, 0) + IFNULL(YE003.H14, 0) + IFNULL(YE003.H15, 0) + IFNULL(YE003.H16, 0) + IFNULL(YE003.R11, 0)               
                    					+ IFNULL(YE003.H06, 0) + IFNULL(YE003.H07, 0) + IFNULL(YE003.Y22, 0) + IFNULL(YE003.H17, 0) + IFNULL(YE003.U01, 0)
                				ELSE 0
            				END) AS 전근무지_비과세소득,    
            				(CASE 
                				WHEN YE002.근무지구분 = '2' THEN IFNULL(YE003.T01, 0) + IFNULL(YE003.T10, 0) + IFNULL(YE003.T11, 0) + IFNULL(YE003.T12, 0) + IFNULL(YE003.T13, 0) + IFNULL(YE003.T20, 0) 
                				ELSE 0
             				END) AS 전근무지_감면소득
        				FROM TBL_YE000 YE000 
          					INNER JOIN TBL_YE002 YE002 
          					ON YE000.계약ID = YE002.계약ID AND YE000.사용자ID = YE002.사용자ID           
          					INNER JOIN TBL_YE003 YE003 
          					ON YE002.계약ID = YE003.계약ID AND YE002.사용자ID = YE003.사용자ID AND YE002.원천명세ID = YE003.원천명세ID  
       					WHERE YE000.계약ID = #계약ID# 
       					AND YE000.사용여부 = '1'
    				) TAB     
    				GROUP BY 계약ID,사용자ID
			) YE002
			ON YE000.계약ID = YE002.계약ID AND YE000.사용자ID = YE002.사용자ID 
			LEFT OUTER JOIN       TBL_YE700 YE700 
			ON YE000.계약ID = YE700.계약ID AND YE000.사용자ID = YE700.사용자ID AND YE700.사용여부 = '1'    
		    LEFT OUTER JOIN
		    tbl_ye006 ye006 ON YE002.계약ID = ye006.계약ID AND YE002.사용자ID = ye006.사용자ID
			WHERE EMP.EMP_TYPE IN ('1','2','3')      
			AND EMP.BIZ_ID = #bizId#     
			AND YE000.계약ID = #계약ID# 
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
			<isNotEmpty property="성명">
				AND EMP.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
			<isNotEmpty property="사번">
				AND EMP.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
			<isNotEmpty property="직책">
				AND EMP.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			ORDER BY EMP.EMP_NO		
	</select>
	
	<!-- 요약표 합계 -->
	<select id="reportDAO.getYE700SummaryListSum" parameterClass="ye700ReportVO" resultClass="ye700ReportVO">
		SELECT
			BIZID,계약ID,
			현근무지_과세소득,현근무지_비과세소득,
			현근무지_감면소득,전근무지_과세소득,전근무지_비과세소득,전근무지_감면소득,
			기납부세액_소득세,기납부세액_지방소득세,기납부세액_농어촌특별세,
      		결정세액_소득세,결정세액_지방소득세,결정세액_농어촌특별세,
      		납부특례_소득세,납부특례_지방소득세,납부특례_농어촌특별세,
      		차감징수_소득세,차감징수_지방소득세,차감징수_농어촌특별세,
      		차량비과세합계
		FROM(
			SELECT    
				<![CDATA[   
	      			EMP.BIZ_ID AS BIZID,
			    	YE000.계약ID,
			    	YE002.현근무지_과세소득,
	        		YE002.현근무지_비과세소득,		    
				  	YE002.현근무지_감면소득,
			    	YE002.전근무지_과세소득,
			    	YE002.전근무지_비과세소득,
				  	YE002.전근무지_감면소득,
					SUM(YE700.주근무지_소득세 + YE700.종근무지_소득세 ) AS 기납부세액_소득세,
					SUM(YE700.주근무지_지방소득세 + YE700.종근무지_지방소득세) AS 기납부세액_지방소득세,
					SUM(YE700.종근무지_농어촌특별세 + YE700.주근무지_농어촌특별세 ) AS 기납부세액_농어촌특별세,
					ifnull(SUM(YE700.결정세액_소득세),0) AS 결정세액_소득세,
					ifnull(SUM(YE700.결정세액_지방소득세),0) AS 결정세액_지방소득세,
					ifnull(SUM(YE700.결정세액_농어촌특별세),0) AS 결정세액_농어촌특별세,
					ifnull(SUM(YE700.납부특례_소득세),0) AS 납부특례_소득세,
					ifnull(SUM(YE700.납부특례_지방소득세),0) AS 납부특례_지방소득세,
					ifnull(SUM(YE700.납부특례_농어촌특별세),0) AS 납부특례_농어촌특별세,
					ifnull(SUM(YE700.차감징수_소득세),0) AS 차감징수_소득세,
					ifnull(SUM(YE700.차감징수_지방소득세),0) AS 차감징수_지방소득세,
					ifnull(SUM(YE700.차감징수_농어촌특별세),0) AS 차감징수_농어촌특별세,  
	      			ifnull(SUM(YE006.차량비과세합계),0) as 차량비과세합계
	      		]]>     
			FROM       TBL_YS000 YS000           
				INNER JOIN       TBL_YS030 YS030 
				ON YS000.계약ID = YS030.계약ID  AND YS030.신고대상 = '1' AND YS030.사용여부 = '1'          
				INNER JOIN       TBL_YE000 YE000 
				ON YS030.계약ID = YE000.계약ID AND YS030.사업장ID = YE000.사업장ID AND YE000.사용여부 = '1'
				INNER JOIN       TBL_EMP EMP 
				ON YS000.BIZ_ID = EMP.BIZ_ID  AND EMP.USER_ID = YE000.사용자ID  AND EMP.USE_YN = 'Y'
				INNER JOIN (
    				SELECT
        				계약ID,
        				SUM(현근무지_과세소득) AS 현근무지_과세소득,
        				SUM(현근무지_비과세소득) AS 현근무지_비과세소득,
        				SUM(현근무지_감면소득) AS 현근무지_감면소득,
        				SUM(전근무지_과세소득) AS 전근무지_과세소득,
        				SUM(전근무지_비과세소득) AS 전근무지_비과세소득,
        				SUM(전근무지_감면소득	) AS 전근무지_감면소득
    				FROM(
        				SELECT
            				YE000.계약ID,
            				YE000.사용자ID,
            				(CASE 
                				WHEN YE002.근무지구분 = '1' THEN IFNULL(YE003.급여, 0) + IFNULL(YE003.상여, 0) + IFNULL(YE003.인정상여, 0) + IFNULL(YE003.직무발명보상금, 0)              
                    				+ IFNULL(YE003.주식매수선택권행사이익, 0) + IFNULL(YE003.우리사주조합인출금, 0) + IFNULL(YE003.임원퇴직소득금액한도초과액, 0)  
                				ELSE 0    
             				END) AS 현근무지_과세소득,       
            				(CASE 
               					WHEN YE002.근무지구분 = '1' THEN IFNULL(YE003.M01, 0) + IFNULL(YE003.M02, 0) + IFNULL(YE003.M03, 0) + IFNULL(YE003.O01, 0)               
                    					+ IFNULL(YE003.Q01, 0) + IFNULL(YE003.H08, 0) + IFNULL(YE003.H09, 0) + IFNULL(YE003.H10, 0) + IFNULL(YE003.G01, 0) + IFNULL(YE003.H11, 0) + IFNULL(YE003.H12, 0)               
                    					+ IFNULL(YE003.H13, 0) + IFNULL(YE003.H01, 0) + IFNULL(YE003.K01, 0) + IFNULL(YE003.S01, 0) + IFNULL(YE003.Y02, 0) + IFNULL(YE003.Y03, 0) + IFNULL(YE003.Y04, 0)               
                    					+ IFNULL(YE003.H05, 0) + IFNULL(YE003.I01, 0) + IFNULL(YE003.R10, 0) + IFNULL(YE003.H14, 0) + IFNULL(YE003.H15, 0) + IFNULL(YE003.H16, 0) + IFNULL(YE003.R11, 0)               
                    					+ IFNULL(YE003.H06, 0) + IFNULL(YE003.H07, 0) + IFNULL(YE003.Y22, 0) + IFNULL(YE003.H17, 0) + IFNULL(YE003.U01, 0) 
               					ELSE 0       
             				END) AS 현근무지_비과세소득,    
            				(CASE 
                				WHEN YE002.근무지구분 = '1' THEN IFNULL(YE003.T01, 0) + IFNULL(YE003.T10, 0) + IFNULL(YE003.T11, 0) + IFNULL(YE003.T12, 0) + IFNULL(YE003.T13, 0) + IFNULL(YE003.T20, 0)  
                				ELSE 0
             				END) AS 현근무지_감면소득,       
            				(CASE 
                				WHEN YE002.근무지구분 = '2' THEN IFNULL(YE003.급여, 0) + IFNULL(YE003.상여, 0) + IFNULL(YE003.인정상여, 0) + IFNULL(YE003.직무발명보상금, 0)              
                    				+ IFNULL(YE003.주식매수선택권행사이익, 0) + IFNULL(YE003.우리사주조합인출금, 0) + IFNULL(YE003.임원퇴직소득금액한도초과액, 0)  
                				ELSE 0     
             				END) AS 전근무지_과세소득,       
            				(CASE 
                				WHEN YE002.근무지구분 = '2' THEN IFNULL(YE003.M01, 0) + IFNULL(YE003.M02, 0) + IFNULL(YE003.M03, 0) + IFNULL(YE003.O01, 0)               
                    					+ IFNULL(YE003.Q01, 0) + IFNULL(YE003.H08, 0) + IFNULL(YE003.H09, 0) + IFNULL(YE003.H10, 0) + IFNULL(YE003.G01, 0) + IFNULL(YE003.H11, 0) + IFNULL(YE003.H12, 0)               
                    					+ IFNULL(YE003.H13, 0) + IFNULL(YE003.H01, 0) + IFNULL(YE003.K01, 0) + IFNULL(YE003.S01, 0) + IFNULL(YE003.Y02, 0) + IFNULL(YE003.Y03, 0) + IFNULL(YE003.Y04, 0)               
                    					+ IFNULL(YE003.H05, 0) + IFNULL(YE003.I01, 0) + IFNULL(YE003.R10, 0) + IFNULL(YE003.H14, 0) + IFNULL(YE003.H15, 0) + IFNULL(YE003.H16, 0) + IFNULL(YE003.R11, 0)               
                    					+ IFNULL(YE003.H06, 0) + IFNULL(YE003.H07, 0) + IFNULL(YE003.Y22, 0) + IFNULL(YE003.H17, 0) + IFNULL(YE003.U01, 0) 
                				ELSE 0
            				END) AS 전근무지_비과세소득,    
            				(CASE 
                				WHEN YE002.근무지구분 = '2' THEN IFNULL(YE003.T01, 0) + IFNULL(YE003.T10, 0) + IFNULL(YE003.T11, 0) + IFNULL(YE003.T12, 0) + IFNULL(YE003.T13, 0) + IFNULL(YE003.T20, 0) 
                				ELSE 0
             				END) AS 전근무지_감면소득
        				FROM TBL_YE000 YE000 
          					INNER JOIN TBL_YE002 YE002 
          					ON YE000.계약ID = YE002.계약ID AND YE000.사용자ID = YE002.사용자ID           
          					INNER JOIN TBL_YE003 YE003 
          					ON YE002.계약ID = YE003.계약ID AND YE002.사용자ID = YE003.사용자ID AND YE002.원천명세ID = YE003.원천명세ID  
       					WHERE YE000.계약ID = #계약ID# 
       					AND YE000.사용여부 = '1'
    				) TAB     
    				GROUP BY 계약ID
			) YE002
			ON YE000.계약ID = YE002.계약ID 
			LEFT OUTER JOIN       TBL_YE700 YE700 
			ON YE000.계약ID = YE700.계약ID AND YE000.사용자ID = YE700.사용자ID AND YE700.사용여부 = '1'    
			LEFT OUTER JOIN (
					<![CDATA[   
					SELECT  
						  계약ID,사용자ID,
						  (CASE WHEN IFNULL(M1, 'N') = 'Y' THEN (CASE WHEN M1금액 - 200000 < 0 THEN M1금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M2, 'N') = 'Y' THEN (CASE WHEN M2금액 - 200000 < 0 THEN M2금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M3, 'N') = 'Y' THEN (CASE WHEN M3금액 - 200000 < 0 THEN M3금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M4, 'N') = 'Y' THEN (CASE WHEN M4금액 - 200000 < 0 THEN M4금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M5, 'N') = 'Y' THEN (CASE WHEN M5금액 - 200000 < 0 THEN M5금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M6, 'N') = 'Y' THEN (CASE WHEN M6금액 - 200000 < 0 THEN M6금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M7, 'N') = 'Y' THEN (CASE WHEN M7금액 - 200000 < 0 THEN M7금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M8, 'N') = 'Y' THEN (CASE WHEN M8금액 - 200000 < 0 THEN M8금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M9, 'N') = 'Y' THEN (CASE WHEN M9금액 - 200000 < 0 THEN M9금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M10, 'N') = 'Y' THEN (CASE WHEN M10금액 - 200000 < 0 THEN M10금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M11, 'N') = 'Y' THEN (CASE WHEN M11금액 - 200000 < 0 THEN M11금액 ELSE 200000 END) ELSE 0 END)
						  + (CASE WHEN IFNULL(M12, 'N') = 'Y' THEN (CASE WHEN M12금액 - 200000 < 0 THEN M12금액 ELSE 200000 END) ELSE 0 END) AS 차량비과세합계
					FROM TBL_YE006  
					WHERE 계약ID = #계약ID# 
					]]>      			
			) YE006
		    ON YE002.계약ID = ye006.계약ID AND YE000.사용자ID = ye006.사용자ID
			WHERE EMP.EMP_TYPE IN ('1','2','3')      
			AND EMP.BIZ_ID = #bizId#     
			AND YE000.계약ID = #계약ID# 
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
			<isNotEmpty property="성명">
				AND EMP.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
			<isNotEmpty property="사번">
				AND EMP.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
			<isNotEmpty property="직책">
				AND EMP.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY EMP.BIZ_ID, YE000.계약ID
		) TAB			
	</select>

	<!-- 공제현황 -->
	<select id="reportDAO.getYE700List" parameterClass="ye700ReportVO" resultClass="ye700ReportVO">
	<![CDATA[
		SELECT 
		    emp.BIZ_ID AS bizId,
		    ys030.사업장ID,
		    ys030.사업장명,
		    ye000.부서ID,
		    FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
		    emp.EMP_NO AS 사번,
		    emp.EMP_NAME AS 성명,
		    emp.POSITION_NAME AS 직책,
		    ye000.개인식별번호,
		    ye000.계약ID,
		    ye000.사용자ID,
		    ye002.회사명,
		    ye002.사업자등록번호,
		    concat(ys000.FEB_YEAR ,'/13') 정산년월,
		    ye000.연말정산분납여부,
		       세액공제구분코드,
		    CASE
            	WHEN SUBSTRING(emp.JOIN_DATE,1,4) = ys000.FEB_YEAR THEN emp.JOIN_DATE  
            	WHEN SUBSTRING(emp.JOIN_DATE,1,4) < ys000.FEB_YEAR THEN CONCAT((DATE_FORMAT(NOW(), '%Y') - 1),'0101') 
          	END AS 근무시작일,
          	CASE 
            	WHEN length(trim(IFNULL(EMP.LEAVE_DATE, ''))) = 0 OR EMP.LEAVE_DATE = '0' THEN CONCAT(YS000.FEB_YEAR, '1231')   
				WHEN SUBSTRING(emp.LEAVE_DATE,1,4) > ys000.FEB_YEAR THEN CONCAT(ys000.FEB_YEAR, '1231') 
				WHEN SUBSTRING(emp.LEAVE_DATE,1,4) < ys000.FEB_YEAR THEN ''
				ELSE emp.LEAVE_DATE
          	END AS 근무종료일,		    
		    ifnull(ye003.G01 + ye003.H01 + ye003.H05 + ye003.H06 + ye003.H07 + ye003.H08 + ye003.H09 + ye003.H10
		      + ye003.H14 + ye003.H15 + ye003.H11 + ye003.H12 + ye003.H13 + ye003.H16 + ye003.H17 + ye003.I01
		      + ye003.K01 + ye003.M01 + ye003.M02 + ye003.M03 + ye003.O01 + ye003.Q01 + ye003.R10 + ye003.R11
		      + ye003.S01 + ye003.U01 + ye003.Y02 + ye003.Y03 + ye003.Y04 + ye003.Y22, 0) as 비과세소득,  
          	ifnull(ye003.T01 + ye003.T10 + ye003.T11 + ye003.T12 + ye003.T13 + ye003.T20, 0) as 감면소득,  
            ifnull(총급여, 0) as 총급여,
            ifnull(근로소득공제, 0) as 근로소득공제,
            ifnull(근로소득금액, 0) as 근로소득금액,
            ifnull(기본공제_본인, 0) as 기본공제_본인,
            ifnull(기본공제_배우자, 0) as 기본공제_배우자,
            ifnull(부양가족_인원수, 0) as 부양가족_인원수,
            ifnull(기본공제_부양가족, 0) as 기본공제_부양가족,
            ifnull(경로우대_인원수, 0) as 경로우대_인원수,
            ifnull(추가공제_경로우대, 0) as 추가공제_경로우대,
            ifnull(장애인_인원수, 0) as 장애인_인원수,
            ifnull(추가공제_장애인, 0) as 추가공제_장애인,
            ifnull(추가공제_부녀자, 0) as 추가공제_부녀자,
            ifnull(추가공제_한부모, 0) as 추가공제_한부모,
            ifnull(인적공제_계, 0) as 인적공제_계,
            ifnull(연금보험_국민연금, 0) as 연금보험_국민연금,
            ifnull(연금보험_국민연금_공제대상금액, 0) as 연금보험_국민연금_공제대상금액,
            ifnull(연금보험_공무원연금, 0) as 연금보험_공무원연금,
            ifnull(연금보험_공무원연금_공제대상금액, 0) as 연금보험_공무원연금_공제대상금액,
            ifnull(연금보험_군인연금, 0) as 연금보험_군인연금,
            ifnull(연금보험_군인연금_공제대상금액, 0) as 연금보험_군인연금_공제대상금액,
            ifnull(연금보험_사립학교, 0) as 연금보험_사립학교,
            ifnull(연금보험_사립학교_공제대상금액, 0) as 연금보험_사립학교_공제대상금액,
            ifnull(연금보험_별정우체국, 0) as 연금보험_별정우체국,
            ifnull(연금보험_별정우체국_공제대상금액, 0) as 연금보험_별정우체국_공제대상금액,
            ifnull(연금보험_계, 0) as 연금보험_계,
            ifnull(특별소득_건강보험, 0) as 특별소득_건강보험,
            ifnull(특별소득_건강보험_공제대상금액, 0) as 특별소득_건강보험_공제대상금액,
            ifnull(특별소득_고용보험, 0) as 특별소득_고용보험,
            ifnull(특별소득_고용보험_공제대상금액, 0) as 특별소득_고용보험_공제대상금액,
            ifnull(특별소득_주택원리금_대출기관, 0) as 특별소득_주택원리금_대출기관,
            ifnull(특별소득_주택원리금_거주자, 0) as 특별소득_주택원리금_거주자,
            ifnull(특별소득_장기주택_2011년이전_15년미만, 0) as 특별소득_장기주택_2011년이전_15년미만,
            ifnull(특별소득_장기주택_2011년이전_15년29년, 0) as 특별소득_장기주택_2011년이전_15년29년,
            ifnull(특별소득_장기주택_2011년이전_30년이상, 0) as 특별소득_장기주택_2011년이전_30년이상,
            ifnull(특별소득_장기주택_2012년이후_고정이거나비거치, 0) as 특별소득_장기주택_2012년이후_고정이거나비거치,
            ifnull(특별소득_장기주택_2012년이후_그밖에, 0) as 특별소득_장기주택_2012년이후_그밖에,
            ifnull(특별소득_장기주택_2015년이후_15년이상_고정이면서비거치, 0) as 특별소득_장기주택_2015년이후_15년이상_고정이면서비거치,
            ifnull(특별소득_장기주택_2015년이후_15년이상_고정이거나비거치, 0) as 특별소득_장기주택_2015년이후_15년이상_고정이거나비거치,
            ifnull(특별소득_장기주택_2015년이후_15년이상_그밖에, 0) as 특별소득_장기주택_2015년이후_15년이상_그밖에,
            ifnull(특별소득_장기주택_2015년이후_10년15년_고정이거나비거치, 0) as 특별소득_장기주택_2015년이후_10년15년_고정이거나비거치,
            ifnull(특별소득_장기주택_2011년이전_15년미만 + 특별소득_장기주택_2011년이전_15년29년 + 특별소득_장기주택_2011년이전_30년이상
            + 특별소득_장기주택_2012년이후_고정이거나비거치 + 특별소득_장기주택_2012년이후_그밖에
            + 특별소득_장기주택_2015년이후_15년이상_고정이면서비거치 + 특별소득_장기주택_2015년이후_15년이상_고정이거나비거치
            + 특별소득_장기주택_2015년이후_15년이상_그밖에 + 특별소득_장기주택_2015년이후_10년15년_고정이거나비거치, 0) as 특별소득_장기주택저당차입금이자상환액_합계,
            ifnull(특별소득_기부금_이월분, 0) as 특별소득_기부금_이월분,
            ifnull(특별소득_계, 0) as 특별소득_계,
            ifnull(차감소득금액, 0) as 차감소득금액,
            ifnull(그밖에소득공제_개인연금, 0) as 그밖에소득공제_개인연금,
            ifnull(그밖에소득공제_소기업소상공인, 0) as 그밖에소득공제_소기업소상공인,
            ifnull(그밖에소득공제_주택마련_청약저축, 0) as 그밖에소득공제_주택마련_청약저축,
            ifnull(그밖에소득공제_주택마련_주택청약, 0) as 그밖에소득공제_주택마련_주택청약,
            ifnull(그밖에소득공제_주택마련_근로자주택마련, 0) as 그밖에소득공제_주택마련_근로자주택마련,
            ifnull(그밖에소득공제_투자조합출자, 0) as 그밖에소득공제_투자조합출자,
            ifnull(그밖에소득공제_투자조합출자_조합, 0) as 그밖에소득공제_투자조합출자_조합,
            ifnull(그밖에소득공제_신용카드등, 0) as 그밖에소득공제_신용카드등,
            ifnull(그밖에소득공제_우리사주조합, 0) as 그밖에소득공제_우리사주조합,
            ifnull(그밖에소득공제_고용유지근로자, 0) as 그밖에소득공제_고용유지근로자,
            ifnull(그밖에소득공제_장기집합투자, 0) as 그밖에소득공제_장기집합투자,
            ifnull(그밖에소득공제_계, 0) as 그밖에소득공제_계,
            ifnull(소득공제종합한도초과액, 0) as 소득공제종합한도초과액,
            ifnull(종합소득과세표준, 0) as 종합소득과세표준,
            ifnull(산출세액, 0) as 산출세액,
            ifnull(세액감면_소득세법, 0) as 세액감면_소득세법,
            ifnull(세액감면_조세특례52제외, 0) as 세액감면_조세특례52제외,
            ifnull(세액감면_조세특례30조, 0) as 세액감면_조세특례30조,
            ifnull(세액감면_조세특례30조_100, 0) as 세액감면_조세특례30조_100,
            ifnull(세액감면_조세특례30조_50, 0) as 세액감면_조세특례30조_50,
            ifnull(세액감면_조세특례30조_70, 0) as 세액감면_조세특례30조_70,
            ifnull(세액감면_조세특례30조_90, 0) as 세액감면_조세특례30조_90,
            ifnull(세액감면_조세조약, 0) as 세액감면_조세조약,
            ifnull(세액감면_계, 0) as 세액감면_계,
            ifnull(세액공제_근로소득, 0) as 세액공제_근로소득,
            ifnull(자녀_인원수, 0) as 자녀_인원수,
            ifnull(세액공제_자녀, 0) as 세액공제_자녀,
            ifnull(세액공제_6세이하_인원수, 0) as 세액공제_6세이하_인원수,
            ifnull(세액공제_6세이하, 0) as 세액공제_6세이하,
            ifnull(출산입양_인원수, 0) as 출산입양_인원수,
            ifnull(세액공제_출산입양, 0) as 세액공제_출산입양,
            ifnull(세액공제_자녀세액공제_계, 0) as 세액공제_자녀세액공제_계,
            ifnull(세액공제_연금계좌_과학기술_공제대상금액, 0) as 세액공제_연금계좌_과학기술_공제대상금액,
            ifnull(세액공제_연금계좌_과학기술_세액공제액, 0) as 세액공제_연금계좌_과학기술_세액공제액,
            ifnull(세액공제_연금계좌_퇴직연금_공제대상금액, 0) as 세액공제_연금계좌_퇴직연금_공제대상금액,
            ifnull(세액공제_연금계좌_퇴직연금_세액공제액, 0) as 세액공제_연금계좌_퇴직연금_세액공제액,
            ifnull(세액공제_연금계좌_연금저축_공제대상금액, 0) as 세액공제_연금계좌_연금저축_공제대상금액,
            ifnull(세액공제_연금계좌_연금저축_세액공제액, 0) as 세액공제_연금계좌_연금저축_세액공제액,
            ifnull(세액공제_연금계좌_계, 0) as 세액공제_연금계좌_계,
            ifnull(특별세액_보험료_보장성_공제대상금액, 0) as 특별세액_보험료_보장성_공제대상금액,
            ifnull(특별세액_보험료_보장성_세액공제액, 0) as 특별세액_보험료_보장성_세액공제액,
            ifnull(특별세액_보험료_장애인전용_공제대상금액, 0) as 특별세액_보험료_장애인전용_공제대상금액,
            ifnull(특별세액_보험료_장애인전용_세액공제액, 0) as 특별세액_보험료_장애인전용_세액공제액,
            ifnull(특별세액_의료비_공제대상금액, 0) as 특별세액_의료비_공제대상금액,
            ifnull(특별세액_의료비_세액공제액, 0) as 특별세액_의료비_세액공제액,
            ifnull(특별세액_교육비_공제대상금액, 0) as 특별세액_교육비_공제대상금액,
            ifnull(특별세액_교육비_세액공제액, 0) as 특별세액_교육비_세액공제액,
            ifnull(특별세액_기부금_정치자금_10만이하_공제대상금액, 0) as 특별세액_기부금_정치자금_10만이하_공제대상금액,
            ifnull(특별세액_기부금_정치자금_10만이하_세액공제액, 0) as 특별세액_기부금_정치자금_10만이하_세액공제액,
            ifnull(특별세액_기부금_정치자금_10만초과_공제대상금액, 0) as 특별세액_기부금_정치자금_10만초과_공제대상금액,
            ifnull(특별세액_기부금_정치자금_10만초과_세액공제액, 0) as 특별세액_기부금_정치자금_10만초과_세액공제액,
            ifnull(특별세액_기부금_법정_공제대상금액, 0) as 특별세액_기부금_법정_공제대상금액,
            ifnull(특별세액_기부금_법정_세액공제액, 0) as 특별세액_기부금_법정_세액공제액,
            ifnull(특별세액_기부금_우리사주_공제대상금액, 0) as 특별세액_기부금_우리사주_공제대상금액,
            ifnull(특별세액_기부금_우리사주_세액공제액, 0) as 특별세액_기부금_우리사주_세액공제액,
            ifnull(특별세액_기부금_지정_종교외_공제대상금액, 0) as 특별세액_기부금_지정_종교외_공제대상금액,
            ifnull(특별세액_기부금_지정_종교외_세액공제액, 0) as 특별세액_기부금_지정_종교외_세액공제액,
            ifnull(특별세액_기부금_지정_종교_공제대상금액, 0) as 특별세액_기부금_지정_종교_공제대상금액,
            ifnull(특별세액_기부금_지정_종교_세액공제액, 0) as 특별세액_기부금_지정_종교_세액공제액,
            ifnull(특별세액_계, 0) as 특별세액_계,
            ifnull(특별세액_표준세액공제, 0) as 특별세액_표준세액공제,
            ifnull(세액공제_납세조합공제, 0) as 세액공제_납세조합공제,
            ifnull(세액공제_주택차입금, 0) as 세액공제_주택차입금,
            ifnull(세액공제_외국납부, 0) as 세액공제_외국납부,
            ifnull(세액공제_월세액_공제대상금액, 0) as 세액공제_월세액_공제대상금액,
            ifnull(세액공제_월세액_세액공제액, 0) as 세액공제_월세액_세액공제액,
            ifnull(세액공제_계, 0) as 세액공제_계,
            ifnull(결정세액_소득세, 0) as 결정세액_소득세,
            ifnull(결정세액_지방소득세, 0) as 결정세액_지방소득세,
            ifnull(결정세액_농어촌특별세, 0) as 결정세액_농어촌특별세,
                        종1_사업자번호,
            ifnull(종1_소득세, 0) as 종1_소득세,
            ifnull(종1_지방소득세, 0) as 종1_지방소득세,
            ifnull(종1_농어촌특별세, 0) as 종1_농어촌특별세,
                        종2_사업자번호,
            ifnull(종2_소득세, 0) as 종2_소득세,
            ifnull(종2_지방소득세, 0) as 종2_지방소득세,
            ifnull(종2_농어촌특별세, 0) as 종2_농어촌특별세,
                        종3_사업자번호,
            ifnull(종3_소득세, 0) as 종3_소득세,
            ifnull(종3_지방소득세, 0) as 종3_지방소득세,
            ifnull(종3_농어촌특별세, 0) as 종3_농어촌특별세,
            ifnull(주근무지_소득세, 0) as 주근무지_소득세,
            ifnull(주근무지_지방소득세, 0) as 주근무지_지방소득세,
            ifnull(주근무지_농어촌특별세, 0) as 주근무지_농어촌특별세,
            ifnull(종근무지_소득세, 0) as 종근무지_소득세,
            ifnull(종근무지_지방소득세, 0) as 종근무지_지방소득세,
            ifnull(종근무지_농어촌특별세, 0) as 종근무지_농어촌특별세,
            ifnull(납부특례_소득세, 0) as 납부특례_소득세,
            ifnull(납부특례_지방소득세, 0) as 납부특례_지방소득세,
            ifnull(납부특례_농어촌특별세, 0) as 납부특례_농어촌특별세,
            ifnull(차감징수_소득세, 0) as 차감징수_소득세,
            ifnull(차감징수_지방소득세, 0) as 차감징수_지방소득세,
            ifnull(차감징수_농어촌특별세, 0) as 차감징수_농어촌특별세
	]]>
		FROM
		    tbl_ys000 ys000
		        INNER JOIN
		    tbl_ys030 ys030 ON ys000.계약ID = ys030.계약ID
		        INNER JOIN
		    tbl_ye000 ye000 ON ys030.계약ID = ye000.계약ID
		        AND ys030.사업장ID = ye000.사업장ID
		        INNER JOIN
		    tbl_emp emp ON ys000.biz_id = emp.biz_id
		        AND emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye002 ye002 ON ye000.계약ID = ye002.계약ID
		        AND ye000.사용자ID = ye002.사용자ID
		        AND ye002.근무지구분 = '1'
		        INNER JOIN
		    tbl_ye003 ye003 ON ye002.계약ID = ye003.계약ID
		        AND ye002.사용자ID = ye003.사용자ID
		        AND ye002.원천명세ID = ye003.원천명세ID
		        INNER JOIN
		    tbl_ye700 ye700 ON ye000.계약ID = ye700.계약ID
		        AND ye000.사용자ID = ye700.사용자ID
		        AND ye700.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
	</select>

	<!-- 공제현황 합계 -->
	<select id="reportDAO.getYE700ListSum" parameterClass="ye700ReportVO" resultClass="ye700ReportVO">
		SELECT 
		    emp.BIZ_ID AS bizId,
		    ye000.계약ID,
		    ifnull(sum(ye003.G01 + ye003.H01 + ye003.H05 + ye003.H06 + ye003.H07 + ye003.H08 + ye003.H09 + ye003.H10
		      + ye003.H14 + ye003.H15 + ye003.H11 + ye003.H12 + ye003.H13 + ye003.H16 + ye003.H17 + ye003.I01
		      + ye003.K01 + ye003.M01 + ye003.M02 + ye003.M03 + ye003.O01 + ye003.Q01 + ye003.R10 + ye003.R11
		      + ye003.S01 + ye003.U01 + ye003.Y02 + ye003.Y03 + ye003.Y04 + ye003.Y22), 0) as 비과세소득,  
          	ifnull(sum(ye003.T01 + ye003.T10 + ye003.T11 + ye003.T12 + ye003.T13 + ye003.T20), 0) AS 감면소득,
			ifnull(sum(세액공제구분코드), 0) 세액공제구분코드,
			ifnull(sum(총급여), 0) 총급여,
			ifnull(sum(근로소득공제), 0) 근로소득공제,
			ifnull(sum(근로소득금액), 0) 근로소득금액,
			ifnull(sum(기본공제_본인), 0) 기본공제_본인,
			ifnull(sum(기본공제_배우자), 0) 기본공제_배우자,
			ifnull(sum(부양가족_인원수), 0) 부양가족_인원수,
			ifnull(sum(기본공제_부양가족), 0) 기본공제_부양가족,
			ifnull(sum(경로우대_인원수), 0) 경로우대_인원수,
			ifnull(sum(추가공제_경로우대), 0) 추가공제_경로우대,
			ifnull(sum(장애인_인원수), 0) 장애인_인원수,
			ifnull(sum(추가공제_장애인), 0) 추가공제_장애인,
			ifnull(sum(추가공제_부녀자), 0) 추가공제_부녀자,
			ifnull(sum(추가공제_한부모), 0) 추가공제_한부모,
			ifnull(sum(인적공제_계), 0) 인적공제_계,
			ifnull(sum(연금보험_국민연금), 0) 연금보험_국민연금,
			ifnull(sum(연금보험_국민연금_공제대상금액), 0) 연금보험_국민연금_공제대상금액,
			ifnull(sum(연금보험_공무원연금), 0) 연금보험_공무원연금,
			ifnull(sum(연금보험_공무원연금_공제대상금액), 0) 연금보험_공무원연금_공제대상금액,
			ifnull(sum(연금보험_군인연금), 0) 연금보험_군인연금,
			ifnull(sum(연금보험_군인연금_공제대상금액), 0) 연금보험_군인연금_공제대상금액,
			ifnull(sum(연금보험_사립학교), 0) 연금보험_사립학교,
			ifnull(sum(연금보험_사립학교_공제대상금액), 0) 연금보험_사립학교_공제대상금액,
			ifnull(sum(연금보험_별정우체국), 0) 연금보험_별정우체국,
			ifnull(sum(연금보험_별정우체국_공제대상금액), 0) 연금보험_별정우체국_공제대상금액,
			ifnull(sum(연금보험_계), 0) 연금보험_계,
			ifnull(sum(특별소득_건강보험), 0) 특별소득_건강보험,
			ifnull(sum(특별소득_건강보험_공제대상금액), 0) 특별소득_건강보험_공제대상금액,
			ifnull(sum(특별소득_고용보험), 0) 특별소득_고용보험,
			ifnull(sum(특별소득_고용보험_공제대상금액), 0) 특별소득_고용보험_공제대상금액,
			ifnull(sum(특별소득_주택원리금_대출기관), 0) 특별소득_주택원리금_대출기관,
			ifnull(sum(특별소득_주택원리금_거주자), 0) 특별소득_주택원리금_거주자,
			ifnull(sum(특별소득_장기주택_2011년이전_15년미만), 0) 특별소득_장기주택_2011년이전_15년미만,
			ifnull(sum(특별소득_장기주택_2011년이전_15년29년), 0) 특별소득_장기주택_2011년이전_15년29년,
			ifnull(sum(특별소득_장기주택_2011년이전_30년이상), 0) 특별소득_장기주택_2011년이전_30년이상,
			ifnull(sum(특별소득_장기주택_2012년이후_고정이거나비거치), 0) 특별소득_장기주택_2012년이후_고정이거나비거치,
			ifnull(sum(특별소득_장기주택_2012년이후_그밖에), 0) 특별소득_장기주택_2012년이후_그밖에,
			ifnull(sum(특별소득_장기주택_2015년이후_15년이상_고정이면서비거치), 0) 특별소득_장기주택_2015년이후_15년이상_고정이면서비거치,
			ifnull(sum(특별소득_장기주택_2015년이후_15년이상_고정이거나비거치), 0) 특별소득_장기주택_2015년이후_15년이상_고정이거나비거치,
			ifnull(sum(특별소득_장기주택_2015년이후_15년이상_그밖에), 0) 특별소득_장기주택_2015년이후_15년이상_그밖에,
			ifnull(sum(특별소득_장기주택_2015년이후_10년15년_고정이거나비거치), 0) 특별소득_장기주택_2015년이후_10년15년_고정이거나비거치,
			ifnull(sum(특별소득_장기주택_2011년이전_15년미만 + 특별소득_장기주택_2011년이전_15년29년 + 특별소득_장기주택_2011년이전_30년이상 
		    + 특별소득_장기주택_2012년이후_고정이거나비거치 + 특별소득_장기주택_2012년이후_그밖에
		    + 특별소득_장기주택_2015년이후_15년이상_고정이면서비거치 + 특별소득_장기주택_2015년이후_15년이상_고정이거나비거치
		    + 특별소득_장기주택_2015년이후_15년이상_그밖에 + 특별소득_장기주택_2015년이후_10년15년_고정이거나비거치), 0) 특별소득_장기주택저당차입금이자상환액_합계,
			ifnull(sum(특별소득_기부금_이월분), 0) 특별소득_기부금_이월분,
			ifnull(sum(특별소득_계), 0) 특별소득_계,
			ifnull(sum(차감소득금액), 0) 차감소득금액,
			ifnull(sum(그밖에소득공제_개인연금), 0) 그밖에소득공제_개인연금,
			ifnull(sum(그밖에소득공제_소기업소상공인), 0) 그밖에소득공제_소기업소상공인,
			ifnull(sum(그밖에소득공제_주택마련_청약저축), 0) 그밖에소득공제_주택마련_청약저축,
			ifnull(sum(그밖에소득공제_주택마련_주택청약), 0) 그밖에소득공제_주택마련_주택청약,
			ifnull(sum(그밖에소득공제_주택마련_근로자주택마련), 0) 그밖에소득공제_주택마련_근로자주택마련,
			ifnull(sum(그밖에소득공제_투자조합출자), 0) 그밖에소득공제_투자조합출자,
			ifnull(sum(그밖에소득공제_투자조합출자_조합), 0) 그밖에소득공제_투자조합출자_조합,
			ifnull(sum(그밖에소득공제_신용카드등), 0) 그밖에소득공제_신용카드등,
			ifnull(sum(그밖에소득공제_우리사주조합), 0) 그밖에소득공제_우리사주조합,
			ifnull(sum(그밖에소득공제_고용유지근로자), 0) 그밖에소득공제_고용유지근로자,
			ifnull(sum(그밖에소득공제_장기집합투자), 0) 그밖에소득공제_장기집합투자,
			ifnull(sum(그밖에소득공제_계), 0) 그밖에소득공제_계,
			ifnull(sum(소득공제종합한도초과액), 0) 소득공제종합한도초과액,
			ifnull(sum(종합소득과세표준), 0) 종합소득과세표준,
			ifnull(sum(산출세액), 0) 산출세액,
			ifnull(sum(세액감면_소득세법), 0) 세액감면_소득세법,
			ifnull(sum(세액감면_조세특례52제외), 0) 세액감면_조세특례52제외,
			ifnull(sum(세액감면_조세특례30조), 0) 세액감면_조세특례30조,
			ifnull(sum(세액감면_조세특례30조_100), 0) 세액감면_조세특례30조_100,
			ifnull(sum(세액감면_조세특례30조_50), 0) 세액감면_조세특례30조_50,
			ifnull(sum(세액감면_조세특례30조_70), 0) 세액감면_조세특례30조_70,
			ifnull(sum(세액감면_조세특례30조_90), 0) 세액감면_조세특례30조_90,
			ifnull(sum(세액감면_조세조약), 0) 세액감면_조세조약,
			ifnull(sum(세액감면_계), 0) 세액감면_계,
			ifnull(sum(세액공제_근로소득), 0) 세액공제_근로소득,
			ifnull(sum(자녀_인원수), 0) 자녀_인원수,
			ifnull(sum(세액공제_자녀), 0) 세액공제_자녀,
			ifnull(sum(세액공제_6세이하_인원수), 0) 세액공제_6세이하_인원수,
			ifnull(sum(세액공제_6세이하), 0) 세액공제_6세이하,
			ifnull(sum(출산입양_인원수), 0) 출산입양_인원수,
			ifnull(sum(세액공제_출산입양), 0) 세액공제_출산입양,
			ifnull(sum(세액공제_자녀세액공제_계), 0) 세액공제_자녀세액공제_계,
			ifnull(sum(세액공제_연금계좌_과학기술_공제대상금액), 0) 세액공제_연금계좌_과학기술_공제대상금액,
			ifnull(sum(세액공제_연금계좌_과학기술_세액공제액), 0) 세액공제_연금계좌_과학기술_세액공제액,
			ifnull(sum(세액공제_연금계좌_퇴직연금_공제대상금액), 0) 세액공제_연금계좌_퇴직연금_공제대상금액,
			ifnull(sum(세액공제_연금계좌_퇴직연금_세액공제액), 0) 세액공제_연금계좌_퇴직연금_세액공제액,
			ifnull(sum(세액공제_연금계좌_연금저축_공제대상금액), 0) 세액공제_연금계좌_연금저축_공제대상금액,
			ifnull(sum(세액공제_연금계좌_연금저축_세액공제액), 0) 세액공제_연금계좌_연금저축_세액공제액,
			ifnull(sum(세액공제_연금계좌_계), 0) 세액공제_연금계좌_계,
			ifnull(sum(특별세액_보험료_보장성_공제대상금액), 0) 특별세액_보험료_보장성_공제대상금액,
			ifnull(sum(특별세액_보험료_보장성_세액공제액), 0) 특별세액_보험료_보장성_세액공제액,
			ifnull(sum(특별세액_보험료_장애인전용_공제대상금액), 0) 특별세액_보험료_장애인전용_공제대상금액,
			ifnull(sum(특별세액_보험료_장애인전용_세액공제액), 0) 특별세액_보험료_장애인전용_세액공제액,
			ifnull(sum(특별세액_의료비_공제대상금액), 0) 특별세액_의료비_공제대상금액,
			ifnull(sum(특별세액_의료비_세액공제액), 0) 특별세액_의료비_세액공제액,
			ifnull(sum(특별세액_교육비_공제대상금액), 0) 특별세액_교육비_공제대상금액,
			ifnull(sum(특별세액_교육비_세액공제액), 0) 특별세액_교육비_세액공제액,
			ifnull(sum(특별세액_기부금_정치자금_10만이하_공제대상금액), 0) 특별세액_기부금_정치자금_10만이하_공제대상금액,
			ifnull(sum(특별세액_기부금_정치자금_10만이하_세액공제액), 0) 특별세액_기부금_정치자금_10만이하_세액공제액,
			ifnull(sum(특별세액_기부금_정치자금_10만초과_공제대상금액), 0) 특별세액_기부금_정치자금_10만초과_공제대상금액,
			ifnull(sum(특별세액_기부금_정치자금_10만초과_세액공제액), 0) 특별세액_기부금_정치자금_10만초과_세액공제액,
			ifnull(sum(특별세액_기부금_법정_공제대상금액), 0) 특별세액_기부금_법정_공제대상금액,
			ifnull(sum(특별세액_기부금_법정_세액공제액), 0) 특별세액_기부금_법정_세액공제액,
			ifnull(sum(특별세액_기부금_우리사주_공제대상금액), 0) 특별세액_기부금_우리사주_공제대상금액,
			ifnull(sum(특별세액_기부금_우리사주_세액공제액), 0) 특별세액_기부금_우리사주_세액공제액,
			ifnull(sum(특별세액_기부금_지정_종교외_공제대상금액), 0) 특별세액_기부금_지정_종교외_공제대상금액,
			ifnull(sum(특별세액_기부금_지정_종교외_세액공제액), 0) 특별세액_기부금_지정_종교외_세액공제액,
			ifnull(sum(특별세액_기부금_지정_종교_공제대상금액), 0) 특별세액_기부금_지정_종교_공제대상금액,
			ifnull(sum(특별세액_기부금_지정_종교_세액공제액), 0) 특별세액_기부금_지정_종교_세액공제액,
			ifnull(sum(특별세액_계), 0) 특별세액_계,
			ifnull(sum(특별세액_표준세액공제), 0) 특별세액_표준세액공제,
			ifnull(sum(세액공제_납세조합공제), 0) 세액공제_납세조합공제,
			ifnull(sum(세액공제_주택차입금), 0) 세액공제_주택차입금,
			ifnull(sum(세액공제_외국납부), 0) 세액공제_외국납부,
			ifnull(sum(세액공제_월세액_공제대상금액), 0) 세액공제_월세액_공제대상금액,
			ifnull(sum(세액공제_월세액_세액공제액), 0) 세액공제_월세액_세액공제액,
			ifnull(sum(세액공제_계), 0) 세액공제_계,
			ifnull(sum(결정세액_소득세), 0) 결정세액_소득세,
			ifnull(sum(결정세액_지방소득세), 0) 결정세액_지방소득세,
			ifnull(sum(결정세액_농어촌특별세), 0) 결정세액_농어촌특별세,
			max(종1_사업자번호) 종1_사업자번호,
			ifnull(sum(종1_소득세), 0) 종1_소득세,
			ifnull(sum(종1_지방소득세), 0) 종1_지방소득세,
			ifnull(sum(종1_농어촌특별세), 0) 종1_농어촌특별세,
			max(종2_사업자번호) 종2_사업자번호,
			ifnull(sum(종2_소득세), 0) 종2_소득세,
			ifnull(sum(종2_지방소득세) , 0) 종2_지방소득세,
			ifnull(sum(종2_농어촌특별세) , 0) 종2_농어촌특별세,
			max(종3_사업자번호) 종3_사업자번호,
			ifnull(sum(종3_소득세) , 0) 종3_소득세,
			ifnull(sum(종3_지방소득세) , 0) 종3_지방소득세,
			ifnull(sum(종3_농어촌특별세) , 0) 종3_농어촌특별세,
			ifnull(sum(주근무지_소득세) , 0) 주근무지_소득세,
			ifnull(sum(주근무지_지방소득세) , 0) 주근무지_지방소득세,
			ifnull(sum(주근무지_농어촌특별세) , 0) 주근무지_농어촌특별세,
			ifnull(sum(종근무지_소득세) , 0) 종근무지_소득세,
			ifnull(sum(종근무지_지방소득세) , 0) 종근무지_지방소득세,
			ifnull(sum(종근무지_농어촌특별세) , 0) 종근무지_농어촌특별세,
			ifnull(sum(납부특례_소득세) , 0) 납부특례_소득세,
			ifnull(sum(납부특례_지방소득세) , 0) 납부특례_지방소득세,
			ifnull(sum(납부특례_농어촌특별세) , 0) 납부특례_농어촌특별세,
			ifnull(sum(차감징수_소득세) , 0) 차감징수_소득세,
			ifnull(sum(차감징수_지방소득세), 0) 차감징수_지방소득세,
			ifnull(sum(차감징수_농어촌특별세), 0) 차감징수_농어촌특별세
		FROM
		    tbl_ys000 ys000
		        INNER JOIN
		    tbl_ys030 ys030 ON ys000.계약ID = ys030.계약ID
		        INNER JOIN
		    tbl_ye000 ye000 ON ys030.계약ID = ye000.계약ID
		        AND ys030.사업장ID = ye000.사업장ID
		        INNER JOIN
		    tbl_emp emp ON ys000.biz_id = emp.biz_id
		        AND emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye002 ye002 ON ye000.계약ID = ye002.계약ID
		        AND ye000.사용자ID = ye002.사용자ID
		        AND ye002.근무지구분 = '1'
		        INNER JOIN
		    tbl_ye003 ye003 ON ye002.계약ID = ye003.계약ID
		        AND ye002.사용자ID = ye003.사용자ID
		        AND ye002.원천명세ID = ye003.원천명세ID
		        INNER JOIN
		    tbl_ye700 ye700 ON ye000.계약ID = ye700.계약ID
		        AND ye000.사용자ID = ye700.사용자ID
		        AND ye700.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
		GROUP BY emp.BIZ_ID, ye000.계약ID
	</select>

	<!-- 공제항목별내역 -->
	<select id="reportDAO.getItem" parameterClass="itemVO" resultClass="itemVO">
		SELECT 
		  	ye000.사업장ID,
			FN_사업장명(ye000.계약ID, ye000.사업장ID) AS 사업장명,
			ye000.부서ID,
			FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
			emp.EMP_NO AS 사번,
			emp.EMP_NAME AS 성명,
			emp.BIZ_ID AS bizId,
		    ye000.개인식별번호,
		    ye000.연말정산분납여부,
		    ye000.계약ID,
		    ye000.사용자ID,
		    ye001.부양가족ID,
		    max(ye001.가족관계) AS 가족관계_코드,
		    FN_CODE_NAME('413', max(ye001.가족관계)) AS 가족관계,
		    max(ye001.내외국인) AS 내외국인,
		    FN_CODE_NAME('414', max(ye001.내외국인)) AS 내외국인명,
		    max(ye001.성명) AS 가족_성명,
		    max(ye001.개인식별번호) AS 가족_개인식별번호,
		    max(ye001.나이) AS 나이,
		    max(ye001.소득확인) AS 소득확인,
		    max(ye001.기본공제) AS 기본공제,
		    max(ye001.부녀자) AS 부녀자,
		    max(ye001.한부모) AS 한부모,
		    max(ye001.경로우대) AS 경로우대,
		    max(ye001.장애인) AS 장애인,
		    max(ye001.자녀) AS 자녀,
		    max(ye001.출산입양) AS 출산입양,
		  	국세청_보장성보험, 국세청_장애인전용보장성보험, 기타_보장성보험, 기타_장애인전용보장성보험,
	    	국세청_의료비, 기타_의료비,
	    	국세청_공납금, 기타_공납금, 국세청_교복구입비, 기타_교복구입비, 국세청_체험학습비, 기타_체험학습비, 국세청_교육비, 기타_교육비,
      		국세청_신용카드, 기타_신용카드, 국세청_직불_선불카드, 기타_직불_선불카드, 국세청_현금영수증, 기타_현금영수증, 국세청_전통시장, 기타_전통시장, 국세청_대중교통, 기타_대중교통, 국세청_도서공연, 기타_도서공연,
	    	국세청_기부금, 기타_기부금,
	    	SUM(건강보험료 +  고용보험료 + 장기요양보험료) AS 건강고용등
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID
		        AND ye000.사용자ID = ye001.사용자ID
		        LEFT OUTER JOIN
            (
              SELECT
            	사용자ID, 부양가족ID,
                IFNULL(SUM(CASE WHEN (자료구분코드 = '0' OR 자료구분코드 = '1') AND 보험구분코드 = '1' THEN 납입금액 - 차감금액 END), 0) 국세청_보장성보험,
       		    IFNULL(SUM(CASE WHEN (자료구분코드 = '0' OR 자료구분코드 = '1') AND 보험구분코드 = '2' THEN 납입금액 - 차감금액 END), 0) 국세청_장애인전용보장성보험,
       		    IFNULL(SUM(CASE WHEN (자료구분코드 = '2' OR 자료구분코드 = '3') AND 보험구분코드 = '1' THEN 납입금액 - 차감금액 END), 0) 기타_보장성보험,
       		    IFNULL(SUM(CASE WHEN (자료구분코드 = '2' OR 자료구분코드 = '3') AND 보험구분코드 = '2' THEN 납입금액 - 차감금액 END), 0) 기타_장애인전용보장성보험
              FROM tbl_ye401
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID ,부양가족ID
		      ) ye401 ON ye001.사용자ID = ye401.사용자ID
		        AND ye001.부양가족ID = ye401.부양가족ID
		        LEFT OUTER JOIN
            (
              SELECT
               	사용자ID, 부양가족ID,
                IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 지출액 - 차감금액 END), 0) 국세청_의료비,
	            IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 지출액 - 차감금액 END), 0) 기타_의료비
              FROM tbl_ye402
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID ,부양가족ID
		      ) ye402 ON ye001.사용자ID = ye402.사용자ID
		        AND ye001.부양가족ID = ye402.부양가족ID
		        LEFT OUTER JOIN
            (
              SELECT
               	사용자ID, 부양가족ID,
                IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 공납금 - 공납금_차감금액 END), 0) 국세청_공납금,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 공납금 - 공납금_차감금액 END), 0) 기타_공납금,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 교복구입비 - 교복구입비_차감금액 END), 0) 국세청_교복구입비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 교복구입비 - 교복구입비_차감금액 END), 0) 기타_교복구입비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 체험학습비 - 체험학습비_차감금액 END), 0) 국세청_체험학습비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 체험학습비 - 체험학습비_차감금액 END), 0) 기타_체험학습비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 END), 0) 국세청_교육비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 END), 0) 기타_교육비
              FROM tbl_ye403
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID ,부양가족ID
		      ) ye403 ON ye001.사용자ID = ye403.사용자ID
		        AND ye001.부양가족ID = ye403.부양가족ID
		        LEFT OUTER JOIN
            (
              SELECT
               	사용자ID ,부양가족ID,
                IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 신용카드 END), 0) 국세청_신용카드,
	            IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 신용카드 END), 0) 기타_신용카드,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 직불_선불카드 END), 0) 국세청_직불_선불카드,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 직불_선불카드 END), 0) 기타_직불_선불카드,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 현금영수증 END), 0) 국세청_현금영수증,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 현금영수증 END), 0) 기타_현금영수증,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 전통시장 END), 0) 국세청_전통시장,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 전통시장 END), 0) 기타_전통시장,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 대중교통 END), 0) 국세청_대중교통,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 대중교통 END), 0) 기타_대중교통,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 도서공연 END), 0) 국세청_도서공연,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 도서공연 END), 0) 기타_도서공연
              FROM tbl_ye108
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID ,부양가족ID
          ) ye108 ON ye001.사용자ID = ye108.사용자ID
		        AND ye001.부양가족ID = ye108.부양가족ID 
		        LEFT OUTER JOIN
            (
              SELECT
               	사용자ID, 부양가족ID,
                IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 기부명세_공제금액 END), 0) 국세청_기부금,
	            IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 기부명세_공제금액 END), 0) 기타_기부금
              FROM tbl_ye404
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID, 부양가족ID
	      ) ye404 ON ye001.사용자ID = ye404.사용자ID
	        AND ye001.부양가족ID = ye404.부양가족ID
	    LEFT OUTER JOIN
	      	tbl_ye002 ye002 ON ye001.계약ID = ye002.계약ID
        	AND ye001.사용자ID = ye002.사용자ID
	  	LEFT OUTER JOIN 
		    tbl_ye003 ye003 ON ye002.계약ID = ye003.계약ID
	        AND ye002.사용자ID = ye003.사용자ID AND ye002.원천명세ID = ye003.원천명세ID
	  	WHERE ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
		GROUP BY ye000.사업장ID, ye000.부서ID, emp.EMP_NO, emp.EMP_NAME, emp.BIZ_ID,
                 ye000.개인식별번호,ye000.연말정산분납여부,ye000.계약ID,ye000.사용자ID,ye001.부양가족ID
	</select>

	<!-- 공제항목별내역 합계 -->
	<select id="reportDAO.getItemSum" parameterClass="itemVO" resultClass="itemVO">
		SELECT bizId, 계약ID,
			SUM(국세청_보장성보험) AS 국세청_보장성보험,
		    SUM(국세청_장애인전용보장성보험) AS 국세청_장애인전용보장성보험,
		    SUM(기타_보장성보험) AS 기타_보장성보험,
		    SUM(기타_장애인전용보장성보험) AS 기타_장애인전용보장성보험,
		    SUM(국세청_의료비) AS 국세청_의료비,
		    SUM(기타_의료비) AS 기타_의료비,
		    SUM(국세청_교육비) AS 국세청_교육비,
		    SUM(기타_교육비) AS 기타_교육비,
		    SUM(국세청_신용카드) AS 국세청_신용카드,
		    SUM(기타_신용카드) AS 기타_신용카드,
		    SUM(국세청_직불_선불카드) AS 국세청_직불_선불카드,
		    SUM(기타_직불_선불카드) AS 기타_직불_선불카드,
		    SUM(국세청_현금영수증) AS 국세청_현금영수증,
		    SUM(기타_현금영수증) AS 기타_현금영수증,
		    SUM(국세청_전통시장) AS 국세청_전통시장,
		    SUM(기타_전통시장) AS 기타_전통시장,
		    SUM(국세청_대중교통) AS 국세청_대중교통,
		    SUM(기타_대중교통) AS 기타_대중교통,
		    SUM(국세청_도서공연) AS 국세청_도서공연,
		    SUM(기타_도서공연) AS 기타_도서공연,
		    SUM(국세청_기부금) AS 국세청_기부금,
		    SUM(기타_기부금) AS 기타_기부금,
        	SUM(건강고용등) AS 건강고용등
        FROM
		(SELECT 
			emp.BIZ_ID AS bizId,
	    	ye000.계약ID,
      		국세청_보장성보험,
		  	국세청_장애인전용보장성보험,
		 	기타_보장성보험,
		  	기타_장애인전용보장성보험,
		  	국세청_의료비,
		  	기타_의료비,
		  	국세청_교육비,
      		기타_교육비,
		  	국세청_신용카드,
	  		기타_신용카드,
		  	국세청_직불_선불카드,
		  	기타_직불_선불카드,
		  	국세청_현금영수증,
		  	기타_현금영수증,
		  	국세청_전통시장,
		  	기타_전통시장,
		  	국세청_대중교통,
		  	기타_대중교통,
		  	국세청_도서공연,
		  	기타_도서공연,
		  	국세청_기부금,
		  	기타_기부금,
		    SUM(건강보험료 +  고용보험료 + 장기요양보험료) AS 건강고용등
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID
		        AND ye000.사용자ID = ye001.사용자ID
		        LEFT OUTER JOIN
            (
              SELECT
               	사용자ID, 부양가족ID,
                IFNULL(SUM(CASE WHEN (자료구분코드 = '0' OR 자료구분코드 = '1') AND 보험구분코드 = '1' THEN 납입금액 - 차감금액 END), 0) 국세청_보장성보험,
       		    IFNULL(SUM(CASE WHEN (자료구분코드 = '0' OR 자료구분코드 = '1') AND 보험구분코드 = '2' THEN 납입금액 - 차감금액 END), 0) 국세청_장애인전용보장성보험,
       		    IFNULL(SUM(CASE WHEN (자료구분코드 = '2' OR 자료구분코드 = '3') AND 보험구분코드 = '1' THEN 납입금액 - 차감금액 END), 0) 기타_보장성보험,
       		    IFNULL(SUM(CASE WHEN (자료구분코드 = '2' OR 자료구분코드 = '3') AND 보험구분코드 = '2' THEN 납입금액 - 차감금액 END), 0) 기타_장애인전용보장성보험
              FROM tbl_ye401
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID ,부양가족ID
		      ) ye401 ON ye001.사용자ID = ye401.사용자ID
		        AND ye001.부양가족ID = ye401.부양가족ID
		        LEFT OUTER JOIN
            (
              SELECT
               	사용자ID, 부양가족ID,
                IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 지출액 - 차감금액 END), 0) 국세청_의료비,
	            IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 지출액 - 차감금액 END), 0) 기타_의료비
              FROM tbl_ye402
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID ,부양가족ID
		      ) ye402 ON ye001.사용자ID = ye402.사용자ID
		        AND ye001.부양가족ID = ye402.부양가족ID
		        LEFT OUTER JOIN
            (
              SELECT
               	 사용자ID, 부양가족ID,
                IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 공납금 - 공납금_차감금액 END), 0) 국세청_공납금,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 공납금 - 공납금_차감금액 END), 0) 기타_공납금,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 교복구입비 - 교복구입비_차감금액 END), 0) 국세청_교복구입비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 교복구입비 - 교복구입비_차감금액 END), 0) 기타_교복구입비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 체험학습비 - 체험학습비_차감금액 END), 0) 국세청_체험학습비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 체험학습비 - 체험학습비_차감금액 END), 0) 기타_체험학습비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 END), 0) 국세청_교육비,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 END), 0) 기타_교육비
              FROM tbl_ye403
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID ,부양가족ID
		      ) ye403 ON ye001.사용자ID = ye403.사용자ID
		        AND ye001.부양가족ID = ye403.부양가족ID
		        LEFT OUTER JOIN
            (
              SELECT
               	 사용자ID ,부양가족ID,
                IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 신용카드 END), 0) 국세청_신용카드,
	            IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 신용카드 END), 0) 기타_신용카드,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 직불_선불카드 END), 0) 국세청_직불_선불카드,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 직불_선불카드 END), 0) 기타_직불_선불카드,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 현금영수증 END), 0) 국세청_현금영수증,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 현금영수증 END), 0) 기타_현금영수증,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 전통시장 END), 0) 국세청_전통시장,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 전통시장 END), 0) 기타_전통시장,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 대중교통 END), 0) 국세청_대중교통,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 대중교통 END), 0) 기타_대중교통,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 도서공연 END), 0) 국세청_도서공연,
       		    IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 도서공연 END), 0) 기타_도서공연
              FROM tbl_ye108
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID ,부양가족ID
          ) ye108 ON ye001.사용자ID = ye108.사용자ID
		        AND ye001.부양가족ID = ye108.부양가족ID 
		        LEFT OUTER JOIN
            (
              SELECT
               	사용자ID, 부양가족ID,
                IFNULL(SUM(CASE WHEN 자료구분코드 = '0' OR 자료구분코드 = '1' THEN 기부명세_공제금액 END), 0) 국세청_기부금,
	            IFNULL(SUM(CASE WHEN 자료구분코드 = '2' OR 자료구분코드 = '3' THEN 기부명세_공제금액 END), 0) 기타_기부금
              FROM tbl_ye404
              WHERE 계약ID = #계약ID#
              AND 사용여부 = '1'
              GROUP BY 사용자ID, 부양가족ID
		      ) ye404 ON ye001.사용자ID = ye404.사용자ID
		        AND ye001.부양가족ID = ye404.부양가족ID
			    LEFT OUTER JOIN
		      tbl_ye002 ye002 ON ye001.계약ID = ye002.계약ID
	        AND ye001.사용자ID = ye002.사용자ID
				  LEFT OUTER JOIN 
			    tbl_ye003 ye003 ON ye002.계약ID = ye003.계약ID
	        AND ye002.사용자ID = ye003.사용자ID AND ye002.원천명세ID = ye003.원천명세ID
		WHERE ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
		GROUP BY emp.BIZ_ID,ye000.계약ID ,ye000.사용자ID,ye001.부양가족ID) X
    GROUP BY X.계약ID, X.bizId
	</select>

	<!-- 종전근무지현황 -->
	<select id="reportDAO.getYE003List" parameterClass="ye003VO" resultClass="ye003VO">
		SELECT 
		    ye000.사업장ID,
		    FN_사업장명(ye000.계약ID, ye000.사업장ID) as 사업장명,
		    ye000.부서ID,
		    FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
		    emp.BIZ_ID as bizId,
		    emp.EMP_NO AS 사번,
		    emp.EMP_NAME AS 성명,
		    emp.POSITION_NAME AS 직책,
		    ye000.개인식별번호,
		    ye000.계약ID,
		    ye000.사용자ID,
		    ye002.근무지구분,
		    fn_code_name('431', ye002.근무지구분) as 근무지구분명,
		    ye002.회사명,
		    ye002.사업자등록번호,
		    ye002.근무시작일 AS 귀속년도시작일,
		    ye002.근무종료일 AS 귀속년도종료일,
		    ye002.감면시작일,
		    ye002.감면종료일,
		    ye003.급여,
		    ye003.상여,
		    ye003.인정상여,
		    ye003.주식매수선택권행사이익,
		    ye003.우리사주조합인출금,
		    ye003.임원퇴직소득금액한도초과액,
		    ye003.국민연금보험료,
		    (ye003.공무원연금 + ye003.군인연금 + ye003.사립학교교직원연금 + ye003.별정우체국연금) AS 공적연금보험료,
		    ye003.건강보험료,
		    ye003.고용보험료,
		    ye003.소득세,
		    ye003.지방소득세,
		    ye003.농어촌특별세,
		    ye003.납부특례세액_소득세,
		    ye003.납부특례세액_지방소득세,
		    ye003.납부특례세액_농어촌특별세,
		    ye003.M01, ye003.M02, ye003.M03, ye003.O01, ye003.Q01, ye003.H08, ye003.H09, ye003.H10,
		    ye003.G01, ye003.H11, ye003.H12, ye003.H13, ye003.H01, ye003.K01, ye003.S01, ye003.Y02,
		    ye003.Y03, ye003.Y04, ye003.H05, ye003.I01, ye003.R10, ye003.H14, ye003.H15, ye003.H16,
		    ye003.R11, ye003.H06, ye003.H07, ye003.Y22, ye003.T13, ye003.H17, ye003.U01,
		    ye003.T01, ye003.T10, ye003.T11, ye003.T12, ye003.T20
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye002 ye002 ON ye000.계약ID = ye002.계약ID
		        AND ye000.사용자ID = ye002.사용자ID
		        INNER JOIN
		    tbl_ye003 ye003 ON ye002.계약ID = ye003.계약ID
		        AND ye002.사용자ID = ye003.사용자ID
		        AND ye002.원천명세ID = ye003.원천명세ID
		WHERE
		      emp.EMP_TYPE IN ('1','2','3')
		  AND ye000.사용여부 = '1'
		  AND ye002.근무지구분 = '2'
		  AND emp.BIZ_ID = #bizId#
		  AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
	</select>
	
	<!-- 종전근무지현황 합계 -->
	<select id="reportDAO.getYE003ListSum" parameterClass="ye003VO" resultClass="ye003VO">
		SELECT 
		    emp.BIZ_ID as bizId,
		    ye000.계약ID,
		    sum(ye003.급여) as 급여,
		    sum(ye003.상여) as 상여,
		    sum(ye003.인정상여) as 인정상여,
		    sum(ye003.주식매수선택권행사이익) as 주식매수선택권행사이익,
		    sum(ye003.우리사주조합인출금) as 우리사주조합인출금,
		    sum(ye003.임원퇴직소득금액한도초과액) as 임원퇴직소득금액한도초과액,
		    sum(ye003.국민연금보험료) as 국민연금보험료,
		    sum(ye003.공무원연금 + ye003.군인연금 + ye003.사립학교교직원연금 + ye003.별정우체국연금) AS 공적연금보험료,
		    sum(ye003.건강보험료) as 건강보험료,
		    sum(ye003.고용보험료) as 고용보험료,
		    sum(ye003.소득세) AS 소득세,
		    sum(ye003.지방소득세) AS 지방소득세,
		    sum(ye003.농어촌특별세) AS 농어촌특별세,
		    sum(ye003.납부특례세액_소득세) as 납부특례세액_소득세,
		    sum(ye003.납부특례세액_지방소득세) as 납부특례세액_지방소득세,
		    sum(ye003.납부특례세액_농어촌특별세) as 납부특례세액_농어촌특별세,
		    sum(ye003.M01) as M01, 
		    sum(ye003.M02) as M02, 
		    sum(ye003.M03) as M03, 
		    sum(ye003.O01) as O01, 
		    sum(ye003.Q01) as Q01, 
		    sum(ye003.H08) as H08, 
		    sum(ye003.H09) as H09, 
		    sum(ye003.H10) as H10,
		    sum(ye003.G01) as G01, 
		    sum(ye003.H11) as H11, 
		    sum(ye003.H12) as H12, 
		    sum(ye003.H13) as H13, 
		    sum(ye003.H01) as H01, 
		    sum(ye003.K01) as K01, 
		    sum(ye003.S01) as S01, 
		    sum(ye003.Y02) as Y02,
		    sum(ye003.Y03) as Y03, 
		    sum(ye003.Y04) as Y04, 
		    sum(ye003.H05) as H05, 
		    sum(ye003.I01) as I01, 
		    sum(ye003.R10) as R10, 
		    sum(ye003.H14) as H14, 
		    sum(ye003.H15) as H15, 
		    sum(ye003.H16) as H16,
		    sum(ye003.R11) as R11, 
		    sum(ye003.H06) as H06, 
		    sum(ye003.H07) as H07, 
		    sum(ye003.Y22) as Y22, 
		    sum(ye003.T13) as T13, 
		    sum(ye003.H17) as H17, 
		    sum(ye003.U01) as U01,
		    sum(ye003.T01) as T01, 
		    sum(ye003.T10) as T10, 
		    sum(ye003.T11) as T11, 
		    sum(ye003.T12) as T12, 
		    sum(ye003.T20) as T20
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye002 ye002 ON ye000.계약ID = ye002.계약ID
		        AND ye000.사용자ID = ye002.사용자ID
		        INNER JOIN
		    tbl_ye003 ye003 ON ye002.계약ID = ye003.계약ID
		        AND ye002.사용자ID = ye003.사용자ID
		        AND ye002.원천명세ID = ye003.원천명세ID
		WHERE
		      emp.EMP_TYPE IN ('1','2','3')
		  AND ye000.사용여부 = '1'
		  AND ye002.근무지구분 = '2'
		  AND emp.BIZ_ID = #bizId#
		  AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
		GROUP BY emp.BIZ_ID, ye000.계약ID
	</select>

	<!-- 의료비명세서 -->
	<select id="reportDAO.getYE402List" parameterClass="ye402ReportVO" resultClass="ye402ReportVO">
		SELECT 
		    ye000.사업장ID,
		    FN_사업장명(ye000.계약ID, ye000.사업장ID) as 사업장명,
		    ye000.부서ID,
		    FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
		    emp.EMP_NO AS 사번,
		    emp.EMP_NAME AS 성명,
		    emp.BIZ_ID as bizId,
		    ye000.개인식별번호,
		    ye000.계약ID,
		    ye000.사용자ID,
		    ye001.부양가족ID,
		    ye001.가족관계,
		    fn_code_name('413', ye001.가족관계) as 가족관계명,
		    ye001.개인식별번호 as 가족_개인식별번호,
		    ye001.성명 as 가족명,
		    ye402.공제종류코드 as 공제종류코드,
		    (case when ye402.공제종류코드 = '1' then '해당' else '미해당' end) as 본인_장애인_65세이상,
		    ye402.의료비증빙코드,
		    fn_code_name('407', ye402.의료비증빙코드) as 의료비증빙코드명,
		    ye402.지급처_사업자등록번호,
		    ye402.상호,
		    ye402.건수,
		    ye402.지출액,
		    ye402.차감금액,
		    (ye402.지출액 - ye402.차감금액) as 합계,
		    ye402.의료비유형,
		    (case when ye402.의료비유형 = '3' then 'O' else 'X' end) as 난임시술비해당여부
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID
		        AND ye000.사용자ID = ye001.사용자ID
		        INNER JOIN
		    tbl_ye402 ye402 ON ye001.계약ID = ye402.계약ID
		        AND ye001.사용자ID = ye402.사용자ID
		        AND ye001.부양가족ID = ye402.부양가족ID
		        AND ye402.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
	</select>

	<!-- 의료비명세서 합계 -->
	<select id="reportDAO.getYE402ListSum" parameterClass="ye402ReportVO" resultClass="ye402ReportVO">
		SELECT 
		    emp.BIZ_ID as bizId,
		    ye000.계약ID,
		    sum(ye402.건수) as 건수,
		    sum(ye402.지출액) as 지출액,
		    sum(ye402.차감금액) as 차감금액,
		    sum(ye402.지출액 - ye402.차감금액) as 합계
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID
		        AND ye000.사용자ID = ye001.사용자ID
		        INNER JOIN
		    tbl_ye402 ye402 ON ye001.계약ID = ye402.계약ID
		        AND ye001.사용자ID = ye402.사용자ID
		        AND ye001.부양가족ID = ye402.부양가족ID
		        AND ye402.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
		GROUP BY
		    emp.BIZ_ID,
		    ye000.계약ID
	</select>

	<!-- 기부금명세서 -->
	<select id="reportDAO.getYE404List" parameterClass="ye404ReportVO" resultClass="ye404ReportVO">
		SELECT 
		    ye000.사업장ID,
		    FN_사업장명(ye000.계약ID, ye000.사업장ID) as 사업장명,
		    ye000.부서ID,
		    FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
		    emp.EMP_NO AS 사번,
		    emp.EMP_NAME AS 성명,
		    emp.BIZ_ID as bizId,
		    ye000.개인식별번호,
		    ye000.계약ID,
		    ye000.사용자ID,
		    ye001.부양가족ID,
		    ye001.가족관계,
		    fn_code_name('413', ye001.가족관계) as 가족관계명,
		    ye001.개인식별번호 as 가족_개인식별번호,
		    ye001.성명 as 가족명,
		    ye404.자료구분코드, 
            fn_code_name('416', ye404.자료구분코드) as 자료구분코드명,
		    ye404.기부코드, 
            fn_code_name('406', ye404.기부코드) as 기부코드명,
		    ye404.기부내용, 
            fn_code_name('429', ye404.기부내용) as 기부내용명,
		    ye404.기부처_사업자등록번호, 
		    ye404.상호, 
		    ye404.기부명세_건수, 
		    ye404.기부명세_공제금액, 
		    ye404.기부명세_공제대상기부금, 
		    ye404.기부명세_기부장려금, 
		    ye404.기부명세_기타,
		    (ye404.기부명세_공제대상기부금 + ye404.기부명세_기부장려금) as 합계 
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID
		        AND ye000.사용자ID = ye001.사용자ID
		        INNER JOIN
		    tbl_ye404 ye404 ON ye001.계약ID = ye404.계약ID
		        AND ye001.사용자ID = ye404.사용자ID
		        AND ye001.부양가족ID = ye404.부양가족ID
		        AND ye404.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
	</select>

	<!-- 기부금명세서 합계 -->
	<select id="reportDAO.getYE404ListSum" parameterClass="ye404ReportVO" resultClass="ye404ReportVO">
		SELECT 
		    emp.BIZ_ID as bizId,
		    ye000.계약ID, 
		    sum(ye404.기부명세_건수) as 기부명세_건수, 
		    sum(ye404.기부명세_공제금액) as 기부명세_공제금액, 
		    sum(ye404.기부명세_공제대상기부금) as 기부명세_공제대상기부금, 
		    sum(ye404.기부명세_기부장려금) as 기부명세_기부장려금, 
		    sum(ye404.기부명세_기타) as 기부명세_기타,
		    sum(ye404.기부명세_공제대상기부금 + ye404.기부명세_기부장려금) as 합계 
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID
		        AND ye000.사용자ID = ye001.사용자ID
		        INNER JOIN
		    tbl_ye404 ye404 ON ye001.계약ID = ye404.계약ID
		        AND ye001.사용자ID = ye404.사용자ID
		        AND ye001.부양가족ID = ye404.부양가족ID
		        AND ye404.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
	    group by  emp.BIZ_ID, ye000.계약ID
	</select>

	<!-- 기부금조정명세서 -->
	<select id="reportDAO.getYE408List" parameterClass="ye408ReportVO" resultClass="ye408ReportVO">
		SELECT 
		    ye000.사업장ID,
		    FN_사업장명(ye000.계약ID, ye000.사업장ID) as 사업장명,
		    ye000.부서ID,
		    FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
		    emp.EMP_NO AS 사번,
		    emp.EMP_NAME AS 성명,
		    emp.BIZ_ID as bizId,
		    ye000.개인식별번호,
		    ye000.계약ID,
		    ye000.사용자ID,
		    ye408.기부년도,            
		    ye408.기부금종류코드, 
		    fn_code_name('406', ye408.기부금종류코드) as 기부금종류코드명,
            sum(ye408.기부금액) as 기부금액, 
            sum(ye408.전년도까지공제금액) as 전년도까지공제금액,
            sum(ye408.공제대상기부금) as 공제대상기부금,
            sum(ye408.공제대상계산기부금) as 공제대상계산기부금,
            sum(ye408.해당연도공제금액) as 해당연도공제금액,
            sum(ye408.이월금액) as 이월금액,
            sum(ye408.소멸금액) as 소멸금액,
            sum(ye407.공제액) as 공제액
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye408 ye408 ON ye000.계약ID = ye408.계약ID
		        AND ye000.사용자ID = ye408.사용자ID
		        AND ye408.사용여부 = '1'
		        INNER JOIN
		    tbl_ye407 ye407 ON ye408.계약ID = ye407.계약ID
		        AND ye408.사용자ID = ye407.사용자ID
		        AND ye408.기부금종류코드 = ye407.기부코드
		        AND ye408.기부년도 = ye407.기부년도
		        INNER JOIN
		    tbl_ye700 ye700 ON ye407.계약ID = ye700.계약ID
		        AND ye407.사용자ID = ye700.사용자ID
		        AND ye700.세액공제구분코드 = ye407.세액공제구분코드
		        AND ye700.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
        GROUP BY  ye000.사업장ID, ye000.부서ID, emp.EMP_NO, emp.EMP_NAME, emp.BIZ_ID, ye000.개인식별번호,
		    ye000.계약ID, ye000.사용자ID, ye408.기부년도,  ye408.기부금종류코드
	</select>

	<!-- 기부금조정명세서 합계-->
	<select id="reportDAO.getYE408ListSum" parameterClass="ye408ReportVO" resultClass="ye408ReportVO">
		SELECT 
		    emp.BIZ_ID as bizId,
		    ye000.계약ID, 
            sum(ye408.기부금액) as 기부금액, 
            sum(ye408.전년도까지공제금액) as 전년도까지공제금액,
            sum(ye408.공제대상기부금) as 공제대상기부금,
            sum(ye408.공제대상계산기부금) as 공제대상계산기부금,
            sum(ye408.해당연도공제금액) as 해당연도공제금액,
            sum(ye408.이월금액) as 이월금액,
            sum(ye408.소멸금액) as 소멸금액,
            sum(ye407.공제액) as 공제액
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye408 ye408 ON ye000.계약ID = ye408.계약ID
		        AND ye000.사용자ID = ye408.사용자ID
		        AND ye408.사용여부 = '1'
		        INNER JOIN
		    tbl_ye407 ye407 ON ye408.계약ID = ye407.계약ID
		        AND ye408.사용자ID = ye407.사용자ID
		        AND ye408.기부금종류코드 = ye407.기부코드
		        AND ye408.기부년도 = ye407.기부년도
		        INNER JOIN
		    tbl_ye700 ye700 ON ye407.계약ID = ye700.계약ID
		        AND ye407.사용자ID = ye700.사용자ID
		        AND ye700.세액공제구분코드 = ye407.세액공제구분코드
		        AND ye700.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
        GROUP BY emp.BIZ_ID, ye000.계약ID
	</select>

	<!-- 연금저축명세서 -->
	<select id="reportDAO.getAnnuitySaving" parameterClass="annuitySavingVO" resultClass="annuitySavingVO">
		SELECT
			사업장ID,
			사업장명,
			부서ID,
			부서명,
			사번,
			성명,
			bizId,
			개인식별번호,
			계약ID,
			사용자ID,
			자료구분코드,
			공제구분,
			항목구분코드,
			항목구분,
			금융회사등명칭코드,
			금융회사등명칭,
			계좌번호_증권번호,
			납입금액,
			차감금액,
			(납입금액 - 차감금액) as 합계
		FROM (
			SELECT 
				ye000.사업장ID,
				FN_사업장명(ye000.계약ID, ye000.사업장ID) as 사업장명,
				ye000.부서ID,
				FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
				emp.EMP_NO AS 사번,
				emp.EMP_NAME AS 성명,
				emp.BIZ_ID as bizId,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
			    ye106.자료구분코드,
				'연금저축' as 공제구분,
				ye106.연금저축구분 as 항목구분코드,
			    fn_code_name('418', ye106.연금저축구분) as 항목구분,
				ye106.금융회사등명칭 as 금융회사등명칭코드,
			    fn_code_name('404', ye106.금융회사등명칭) as 금융회사등명칭,
				ye106.계좌번호_증권번호,
				ye106.납입금액,
				ye106.차감금액
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye106 ye106 ON ye000.계약ID = ye106.계약ID
					AND ye000.사용자ID = ye106.사용자ID
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
	    	AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
			union all
			SELECT 
			    ye000.사업장ID,
			    FN_사업장명(ye000.계약ID, ye000.사업장ID) AS 사업장명,
			    ye000.부서ID,
			    FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
			    emp.EMP_NO AS 사번,
			    emp.EMP_NAME AS 성명,
			    emp.BIZ_ID AS bizId,
			    ye000.개인식별번호,
			    ye000.계약ID,
			    ye000.사용자ID,
			    ye107.자료구분코드,
			    '주택마련저축' as 공제구분,
			    ye107.주택마련저축구분 as 항목구분코드,
			    fn_code_name('418', ye107.주택마련저축구분) as 항목구분,
			    ye107.금융회사등명칭 as 금융회사등명칭코드,
			    fn_code_name('404', ye107.금융회사등명칭) as 금융회사등명칭,
			    ye107.계좌번호_증권번호,
			    ye107.납입금액,
			    ye107.차감금액
			FROM
			    tbl_emp emp
			        INNER JOIN
			    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
			        INNER JOIN
			    tbl_ye107 ye107 ON ye000.계약ID = ye107.계약ID
			        AND ye000.사용자ID = ye107.사용자ID
			WHERE
			    ye000.사용여부 = '1'
			    AND emp.EMP_TYPE IN ('1' , '2', '3')
			    AND emp.BIZ_ID = #bizId#
	    		AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
			union all
			SELECT
				ye000.사업장ID,
				FN_사업장명(ye000.계약ID, ye000.사업장ID) as 사업장명,
				ye000.부서ID,
				FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
				emp.EMP_NO AS 사번,
				emp.EMP_NAME AS 성명,
				emp.BIZ_ID as bizId,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				ye109.자료구분코드,
			    '장기집합투자' as 공제구분,
			    '' as 항목구분코드,
			    '장기집합투자증권저축' as 항목구분,
				ye109.취급기관명 as 금융회사등명칭코드,
			    fn_code_name('404', ye109.취급기관명) as 금융회사등명칭,
				ye109.계좌번호_증권번호,
				ye109.납입금액,
				ye109.차감금액
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye109 ye109 ON ye000.계약ID = ye109.계약ID
					AND ye000.사용자ID = ye109.사용자ID
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
	    	AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
		) t
	</select>

	<!-- 연금저축명세서 합계 -->
	<select id="reportDAO.getAnnuitySavingSum" parameterClass="annuitySavingVO" resultClass="annuitySavingVO">
		SELECT
			bizId,
			계약ID,
			sum(납입금액) as 납입금액,
			sum(차감금액) as 차감금액,
			sum(납입금액 - 차감금액) as 합계
		FROM (
			SELECT 
				emp.BIZ_ID as bizId,
				ye000.계약ID,
				ye106.납입금액,
				ye106.차감금액
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye106 ye106 ON ye000.계약ID = ye106.계약ID
					AND ye000.사용자ID = ye106.사용자ID
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
	    	AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
			union all
			SELECT 
			    emp.BIZ_ID AS bizId,
			    ye000.계약ID,
			    ye107.납입금액,
			    ye107.차감금액
			FROM
			    tbl_emp emp
			        INNER JOIN
			    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
			        INNER JOIN
			    tbl_ye107 ye107 ON ye000.계약ID = ye107.계약ID
			        AND ye000.사용자ID = ye107.사용자ID
			WHERE
			    ye000.사용여부 = '1'
			    AND emp.EMP_TYPE IN ('1' , '2', '3')
			    AND emp.BIZ_ID = #bizId#
	    		AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
			union all
			SELECT
				emp.BIZ_ID as bizId,
				ye000.계약ID,
				ye109.납입금액,
				ye109.차감금액
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye109 ye109 ON ye000.계약ID = ye109.계약ID
					AND ye000.사용자ID = ye109.사용자ID
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
	    	AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
		) t
		GROUP BY bizId, 계약ID
	</select>

	<!-- 월세공제명세서 -->
	<select id="reportDAO.getYE105List" parameterClass="ye105ReportVO" resultClass="ye105ReportVO">
		SELECT 
		    ye000.사업장ID,
		    FN_사업장명(ye000.계약ID, ye000.사업장ID) as 사업장명,
		    ye000.부서ID,
		    FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
		    emp.EMP_NO AS 사번,
		    emp.EMP_NAME AS 성명,
		    emp.BIZ_ID as bizId,
		    ye000.개인식별번호,
		    ye000.계약ID,
		    ye000.사용자ID,
		    ye105.임대인성명_상호,
		    ye105.개인식별번호 as 임대인_개인식별번호,
		    ye105.유형코드,
		    fn_code_name('415', ye105.유형코드) as 유형코드명,
		    ye105.계약면적,
		    ye105.임대차_주소지_물건지,
		    ye105.임대차_계약개시일,
		    ye105.임대차_계약종료일,
		    ye105.연간_월세액,
		    ye105.공제대상금액
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye105 ye105 ON ye000.계약ID = ye105.계약ID
		        AND ye000.사용자ID = ye105.사용자ID
		        AND ye105.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1' , '2', '3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
	</select>

	<!-- 월세공제명세서 합계 -->
	<select id="reportDAO.getYE105ListSum" parameterClass="ye105ReportVO" resultClass="ye105ReportVO">
		SELECT 
		    emp.BIZ_ID as bizId,
		    ye000.계약ID,
		    sum(ye105.연간_월세액) as 연간_월세액,
		    sum(ye105.공제대상금액) as 공제대상금액 
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye105 ye105 ON ye000.계약ID = ye105.계약ID
		        AND ye000.사용자ID = ye105.사용자ID
		        AND ye105.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1' , '2', '3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
		GROUP BY
		    emp.BIZ_ID,
		    ye000.계약ID
	</select>

	<!-- 주택임차 차입금원리금 상환명세서 -->
	<select id="reportDAO.getYE101List" parameterClass="ye101VO" resultClass="ye101VO">
		SELECT 
			ye000.사업장ID,
			FN_사업장명(ye000.계약ID, ye000.사업장ID) as 사업장명,
			ye000.부서ID,
			FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
			emp.EMP_NO AS 사번,
			emp.EMP_NAME AS 성명,
			emp.BIZ_ID as bizId,
			ye000.개인식별번호,
			ye000.계약ID,
			ye000.사용자ID,
		    sum(case when ye101.차입구분 = '1' then 국세청자료 + 기타자료 - 차감금액 else 0 end) as 대출기관,
		    sum(case when ye101.차입구분 = '2' then 국세청자료 + 기타자료 - 차감금액 else 0 end) as 거주자
		FROM
			tbl_emp emp
				INNER JOIN
			tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
				INNER JOIN
			tbl_ye101 ye101 ON ye000.계약ID = ye101.계약ID
				AND ye000.사용자ID = ye101.사용자ID
				AND ye101.사용여부 = '1'
		WHERE
			ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
		GROUP BY ye000.사업장ID, ye000.부서ID, emp.EMP_NO, emp.EMP_NAME, emp.BIZ_ID, ye000.개인식별번호, ye000.계약ID, ye000.사용자ID
	</select>

	<!-- 주택임차 차입금원리금 상환명세서 합계 -->
	<select id="reportDAO.getYE101ListSum" parameterClass="ye101VO" resultClass="ye101VO">
		SELECT 
			emp.BIZ_ID as bizId,
			ye000.계약ID,
		    sum(case when ye101.차입구분 = '1' then 국세청자료 + 기타자료 - 차감금액 else 0 end) as 대출기관,
		    sum(case when ye101.차입구분 = '2' then 국세청자료 + 기타자료 - 차감금액 else 0 end) as 거주자
		FROM
			tbl_emp emp
				INNER JOIN
			tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
				INNER JOIN
			tbl_ye101 ye101 ON ye000.계약ID = ye101.계약ID
				AND ye000.사용자ID = ye101.사용자ID
				AND ye101.사용여부 = '1'
		WHERE
			ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1','2','3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
		GROUP BY emp.BIZ_ID, ye000.계약ID
	</select>


	<!-- 장기주택저당차입금명세서 -->
	<select id="reportDAO.getYE104List" parameterClass="ye104VO" resultClass="ye104VO">
		SELECT 
		    ye000.사업장ID,
		    FN_사업장명(ye000.계약ID, ye000.사업장ID) as 사업장명,
		    ye000.부서ID,
		    FN_부서명(ye000.계약ID, ye000.부서ID, ye000.사용자ID) 부서명,
		    emp.EMP_NO AS 사번,
		    emp.EMP_NAME AS 성명,
		    emp.BIZ_ID as bizId,
		    ye000.개인식별번호,
		    ye000.계약ID,
		    ye000.사용자ID,
		    sum(ifnull(case when ye104.구분코드 = 1 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code1,
		    sum(ifnull(case when ye104.구분코드 = 2 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code2,
		    sum(ifnull(case when ye104.구분코드 = 3 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code3,
		    sum(ifnull(case when ye104.구분코드 = 4 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code4,
		    sum(ifnull(case when ye104.구분코드 = 5 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code5,
		    sum(ifnull(case when ye104.구분코드 = 6 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code6,
		    sum(ifnull(case when ye104.구분코드 = 7 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code7,
		    sum(ifnull(case when ye104.구분코드 = 8 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code8,
		    sum(ifnull(case when ye104.구분코드 = 9 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code9,
		    sum(ifnull(case when ye104.구분코드 = 1 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 2 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 3 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 4 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 5 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 6 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 7 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 8 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 9 then 국세청자료 + 기타자료 - 차감금액 end, 0)) 합계
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye104 ye104 ON ye000.계약ID = ye104.계약ID
		        AND ye000.사용자ID = ye104.사용자ID
		        AND ye104.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1' , '2', '3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
		group by  ye000.사업장ID, ye000.부서ID, emp.EMP_NO, emp.EMP_NAME, emp.BIZ_ID, ye000.개인식별번호, ye000.계약ID, ye000.사용자ID
	</select>

	<!-- 장기주택저당차입금명세서 합계 -->
	<select id="reportDAO.getYE104ListSum" parameterClass="ye104VO" resultClass="ye104VO">
		SELECT 
		    emp.BIZ_ID as bizId,
		    ye000.계약ID,
		    sum(ifnull(case when ye104.구분코드 = 1 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code1,
		    sum(ifnull(case when ye104.구분코드 = 2 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code2,
		    sum(ifnull(case when ye104.구분코드 = 3 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code3,
		    sum(ifnull(case when ye104.구분코드 = 4 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code4,
		    sum(ifnull(case when ye104.구분코드 = 5 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code5,
		    sum(ifnull(case when ye104.구분코드 = 6 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code6,
		    sum(ifnull(case when ye104.구분코드 = 7 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code7,
		    sum(ifnull(case when ye104.구분코드 = 8 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code8,
		    sum(ifnull(case when ye104.구분코드 = 9 then 국세청자료 + 기타자료 - 차감금액 end, 0)) code9,
		    sum(ifnull(case when ye104.구분코드 = 1 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 2 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 3 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 4 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 5 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 6 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 7 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 8 then 국세청자료 + 기타자료 - 차감금액 end, 0)
		      + ifnull(case when ye104.구분코드 = 9 then 국세청자료 + 기타자료 - 차감금액 end, 0)) 합계
		    
		FROM
		    tbl_emp emp
		        INNER JOIN
		    tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
		        INNER JOIN
		    tbl_ye104 ye104 ON ye000.계약ID = ye104.계약ID
		        AND ye000.사용자ID = ye104.사용자ID
		        AND ye104.사용여부 = '1'
		WHERE
		    ye000.사용여부 = '1'
		AND emp.EMP_TYPE IN ('1' , '2', '3')
		AND emp.BIZ_ID = #bizId#
	    AND ye000.계약ID = #계약ID#
		<isNotNull property="사업장ID">
			<isNotEmpty property="사업장ID">
				AND ye000.사업장ID		= #사업장ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="부서ID">
			<isNotEmpty property="부서ID">
				AND ye000.부서ID		= #부서ID#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="성명">
			<isNotEmpty property="성명">
				AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="사번">
			<isNotEmpty property="사번">
				AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="직책">
			<isNotEmpty property="직책">
				AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="근무상태">
		    <isNotEmpty property="근무상태">
			    <isEqual property="근무상태"  compareValue="1">
					AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
				</isEqual>
			    <isEqual property="근무상태"  compareValue="2">
					AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
				</isEqual>
			</isNotEmpty>
		</isNotNull>
		group by  emp.BIZ_ID, ye000.계약ID
	</select>

	<!-- 입력현황 -->
	<select id="reportDAO.getInputStatus" parameterClass="inputStatusVO" resultClass="inputStatusVO">
		select
			BIZ_ID AS bizId,
			사업장ID,
			FN_사업장명(계약ID, 사업장ID) AS 사업장명,
			부서ID,
			FN_부서명(계약ID, 부서ID, 사용자ID) 부서명,
			EMP_NO AS 사번,
			EMP_NAME AS 성명,
			개인식별번호,
			계약ID,
			사용자ID,
			max(연말정산분납여부) 연말정산분납여부,
			max(정산년월) 정산년월,
			max(근무시작일) 근무시작일,
			max(근무종료일) 근무종료일,
			SUM(급여) 급여,
			SUM(상여) 상여,
			SUM(인정상여) 인정상여,
			SUM(주식매수선택권행사이익) 주식매수선택권행사이익,
			SUM(우리사주조합인출금) 우리사주조합인출금,
			SUM(임원퇴직소득금액한도초과액) AS 임원퇴직소득금액한도초과액,
			SUM(직무발명보상금) AS 직무발명보상금,
			sum(국민연금보험료) 국민연금보험료,
			sum(공적연금) AS 공적연금,
			sum(건강보험료) 건강보험료,
			sum(고용보험료) 고용보험료,
			sum(기납부세액_소득세) 기납부세액_소득세,
			sum(기납부세액_지방소득세) 기납부세액_지방소득세,
			sum(기납부세액_농어촌특별세) 기납부세액_농어촌특별세,
			sum(M01) M01,
			sum(M02) M02,
			sum(M03) M03,
			sum(O01) O01,
			sum(Q01) Q01,
			sum(H08) H08,
			sum(H09) H09,
			sum(H10) H10,
			sum(G01) G01,
			sum(H11) H11,
			sum(H12) H12,
			sum(H13) H13,
			sum(H01) H01,
			sum(K01) K01,
			sum(S01) S01,
			sum(T01) T01,
			sum(Y02) Y02,
			sum(Y03) Y03,
			sum(Y04) Y04,
			sum(H05) H05,
			sum(I01) I01,
			sum(R10) R10,
			sum(H14) H14,
			sum(H15) H15,
			sum(T10) T10,
			sum(T11) T11,
			sum(T12) T12,
			sum(T20) T20,
			sum(H16) H16,
			sum(R11) R11,
			sum(H06) H06,
			sum(H07) H07,
			sum(Y22) Y22,
			sum(T13) T13,
			sum(H17) H17,
			sum(U01) U01,
			max(기본공제_배우자유무) 기본공제_배우자유무, 
			sum(기본공제_20세이하) 기본공제_20세이하, 
			sum(기본공제_60세이상) 기본공제_60세이상, 
			sum(기본공제_장애인) 기본공제_장애인, 
			sum(기본공제_기타수급자_위탁아동) 기본공제_기타수급자_위탁아동, 
			sum(추가공제_경로우대) 추가공제_경로우대, 
			sum(추가공제_장애인) 추가공제_장애인, 
			sum(추가공제_부녀자) 추가공제_부녀자, 
			sum(추가공제_한부모) 추가공제_한부모, 
			sum(세액공제_자녀인원수) 세액공제_자녀인원수, 
			sum(세액공제_6세이하자녀수) 세액공제_6세이하자녀수, 
			sum(세액공제_출산_입양자녀수) 세액공제_출산_입양자녀수,
			sum(신용카드) 신용카드,
			sum(직불_선불카드) 직불_선불카드,
			sum(현금영수증) 현금영수증,
			sum(전통시장) 전통시장,
			sum(대중교통) 대중교통,
			sum(도서공연) 도서공연,
			sum(특별소득공제_주택자금1) 특별소득공제_주택자금1,
			sum(특별소득공제_주택자금2) 특별소득공제_주택자금2,
			sum(특별소득공제_주택자금3) 특별소득공제_주택자금3,
			sum(특별소득공제_주택자금4) 특별소득공제_주택자금4,
			sum(특별소득공제_주택자금5) 특별소득공제_주택자금5,
			sum(특별소득공제_주택자금6) 특별소득공제_주택자금6,
			sum(특별소득공제_주택자금7) 특별소득공제_주택자금7,
			sum(특별소득공제_주택자금8) 특별소득공제_주택자금8,
			sum(특별소득공제_주택자금9) 특별소득공제_주택자금9,
			sum(특별세액공제_의료비_난임시술비등) 특별세액공제_의료비_난임시술비등,
			sum(특별세액공제_의료비_난임시술비등_그밖) 특별세액공제_의료비_난임시술비등_그밖,
			sum(특별세액공제_의료비_안경구입_본인) 특별세액공제_의료비_안경구입_본인,
			sum(특별세액공제_의료비_안경구입_그밖) 특별세액공제_의료비_안경구입_그밖,
			sum(본인교육비) 본인교육비,
			sum(취학전인원) 취학전인원,
			sum(취학전교육비) 취학전교육비,
			sum(초중고인원) 초중고인원,
			sum(초중고교육비) 초중고교육비,
			sum(교복구입비) 교복구입비,
			sum(체험학습비) 체험학습비,
			sum(대학생인원) 대학생인원,
			sum(대학생교육비) 대학생교육비,
			sum(장애인인원) 장애인인원,
			sum(장애인교육비) 장애인교육비,
			sum(정치기부금10만원이하) 정치기부금10만원이하,
			sum(정치기부금10만원초과) 정치기부금10만원초과,
			sum(법정기부금) 법정기부금,
			sum(우리사주기부금) 우리사주기부금,
			sum(종교단체외기부금) 종교단체외기부금,
			sum(종교단체기부금) 종교단체기부금,
			sum(연금보험료공제_국민연금_지역) 연금보험료공제_국민연금_지역,
			sum(건강보험료_지역) 건강보험료_지역,
			sum(대출기관) 대출기관,
			sum(거주자) 거주자,
			sum(기부금_이월분) 기부금_이월분,
			sum(개인연금저축납입액) 개인연금저축납입액,
			sum(소기업소상공인공제부금) 소기업소상공인공제부금,
			sum(주택마련저축불입액) 주택마련저축불입액,
			sum(투자조합출자등투자금액) 투자조합출자등투자금액,
			sum(우리사주조합출연금) 우리사주조합출연금,
			sum(고용유지중소기업) 고용유지중소기업,
			sum(장기집합투자증권저축) 장기집합투자증권저축,
			sum(세액감면_소득세법) 세액감면_소득세법,			
			sum(세액공제_퇴직연금소득공제) 세액공제_퇴직연금소득공제,
			sum(세액공제_과학기술인공제) 세액공제_과학기술인공제,
			sum(세액공제_연금저축) 세액공제_연금저축,
			sum(특별세액공제_보험료_보장성보험) 특별세액공제_보험료_보장성보험,
			sum(특별세액공제_보험료_장애인전용보장성보험) 특별세액공제_보험료_장애인전용보장성보험,
			sum(납세조합공제) 납세조합공제,
			sum(주택차입금) 주택차입금,
			sum(외국납부) 외국납부,
			sum(연간_월세액) 연간_월세액,
			sum(차량비과세합계) 차량비과세합계
		from (
			SELECT 
	<![CDATA[
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				ye000.연말정산분납여부,
				concat(ys000.FEB_YEAR ,'/13') 정산년월,
				max(CASE               
				  WHEN SUBSTRING(emp.JOIN_DATE,1,4) = ys000.FEB_YEAR THEN emp.JOIN_DATE                 
				  WHEN SUBSTRING(emp.JOIN_DATE,1,4) < ys000.FEB_YEAR THEN CONCAT(ys000.FEB_YEAR,'0101')              
				END) AS 근무시작일,
	          	max(CASE 
          			 WHEN emp.LEAVE_DATE = '0' THEN CONCAT(ys000.FEB_YEAR,'1231')
    			     WHEN emp.LEAVE_DATE = '00000000' THEN CONCAT(ys000.FEB_YEAR,'1231')
    			     WHEN emp.LEAVE_DATE = '00000101' THEN CONCAT(ys000.FEB_YEAR,'1231')
            	  	 WHEN IFNULL(emp.LEAVE_DATE,'') = '' THEN CONCAT(ys000.FEB_YEAR,'1231')
            	  	 WHEN SUBSTRING(emp.LEAVE_DATE,1,4) > ys000.FEB_YEAR THEN CONCAT(ys000.FEB_YEAR,'1231') 
            	  	 ELSE emp.LEAVE_DATE
          		END) AS 근무종료일,
				SUM((IFNULL(ye003.급여,0)+IFNULL(ye003.비과세한도초과액,0)-IFNULL(K.차량비과세, 0))) 급여, 
				SUM(ye003.상여) 상여,
				SUM(ye003.인정상여) 인정상여,
				SUM(ye003.주식매수선택권행사이익) 주식매수선택권행사이익,
				SUM(ye003.우리사주조합인출금) 우리사주조합인출금,
				SUM(ye003.임원퇴직소득금액한도초과액) 임원퇴직소득금액한도초과액,
				SUM(ye003.직무발명보상금) AS 직무발명보상금,
				sum(ye003.국민연금보험료) 국민연금보험료,
				sum(ye003.공무원연금 + ye003.군인연금 + ye003.사립학교교직원연금 + ye003.별정우체국연금) AS 공적연금,
				sum(ye003.건강보험료) 건강보험료,
				sum(ye003.고용보험료) 고용보험료,
				sum(ye003.소득세) 기납부세액_소득세,
				sum(ye003.지방소득세) 기납부세액_지방소득세,
				sum(ye003.농어촌특별세) 기납부세액_농어촌특별세,
				sum(ye003.M01) M01,
				sum(ye003.M02) M02,
				sum(ye003.M03) M03,
				sum(ye003.O01) O01,
				sum(ye003.Q01) Q01,
				sum(ye003.H08) H08,
				sum(ye003.H09) H09,
				sum(ye003.H10) H10,
				sum(ye003.G01) G01,
				sum(ye003.H11) H11,
				sum(ye003.H12) H12,
				sum(ye003.H13) H13,
				sum(ye003.H01) H01,
				sum(ye003.K01) K01,
				sum(ye003.S01) S01,
				sum(ye003.T01) T01,
				sum(ye003.Y02) Y02,
				sum(ye003.Y03) Y03,
				sum(ye003.Y04) Y04,
				sum(ye003.H05) H05,
				sum(ye003.I01) I01,
				sum(ye003.R10) R10,
				sum(ye003.H14) H14,
				sum(ye003.H15) H15,
				sum(ye003.T10) T10,
				sum(ye003.T11) T11,
				sum(ye003.T12) T12,
				sum(ye003.T20) T20,
				sum(ye003.H16) H16,
				sum(ye003.R11) R11,
				sum(ye003.H06) H06,
				sum(ye003.H07) H07,
				sum(ye003.Y22) Y22,
				sum(ye003.T13) T13,
				sum(ye003.H17) H17,
				sum(ye003.U01) U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				sum(k.차량비과세) AS 차량비과세합계 
	]]>
			FROM
				tbl_ys000 ys000
			     INNER JOIN tbl_ys030 ys030 
			      ON ys000.계약ID = ys030.계약ID
			     INNER JOIN tbl_ye000 ye000 
			      ON ys030.계약ID = ye000.계약ID AND ys030.사업장ID = ye000.사업장ID
			     INNER JOIN tbl_emp emp 
			      ON ys000.biz_id = emp.biz_id AND emp.user_id = ye000.사용자ID
			     INNER JOIN tbl_ye002 ye002 
			      ON ye000.계약ID = ye002.계약ID AND ye000.사용자ID = ye002.사용자ID
			     INNER JOIN tbl_ye003 ye003 
				  ON ye002.계약ID = ye003.계약ID AND ye002.사용자ID = ye003.사용자ID AND ye002.원천명세ID = ye003.원천명세ID
				  LEFT OUTER JOIN (
			       	SELECT  T1.계약ID, T1.사용자ID,
					       (CASE WHEN T1.M1 = 'Y' THEN CASE WHEN IFNULL(T1.M1금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M1금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M2 = 'Y' THEN CASE WHEN IFNULL(T1.M2금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M2금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M3 = 'Y' THEN CASE WHEN IFNULL(T1.M3금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M3금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M4 = 'Y' THEN CASE WHEN IFNULL(T1.M4금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M4금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M5 = 'Y' THEN CASE WHEN IFNULL(T1.M5금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M5금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M6 = 'Y' THEN CASE WHEN IFNULL(T1.M6금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M6금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M7 = 'Y' THEN CASE WHEN IFNULL(T1.M7금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M7금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M8 = 'Y' THEN CASE WHEN IFNULL(T1.M8금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M8금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M9 = 'Y' THEN CASE WHEN IFNULL(T1.M9금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M9금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M10 = 'Y' THEN CASE WHEN IFNULL(T1.M10금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M10금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M11 = 'Y' THEN CASE WHEN IFNULL(T1.M11금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M11금액, 0) END ELSE 0 END +
					        CASE WHEN T1.M12 = 'Y' THEN CASE WHEN IFNULL(T1.M12금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M12금액, 0) END ELSE 0 END) 차량비과세
					FROM  TBL_YE006 T1
					WHERE T1.계약ID = #계약ID#
        		) K
        		ON ye000.계약ID = K.계약ID AND ye000.사용자ID = K.사용자ID	
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			<![CDATA[
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				(case when sum(case when ye001.기본공제 = '1' and ye001.가족관계 = '3' then 1 else 0 end) > 0 then 'O' else 'X' end) 기본공제_배우자유무,
				sum(case when ye001.기본공제 = '1' and ye001.나이 <= 20 then 1 else 0 end) 기본공제_20세이하,
				sum(case when ye001.기본공제 = '1' and ye001.나이 >= 60 then 1 else 0 end) 기본공제_60세이상,
				sum(case when ye001.기본공제 = '1' and ye001.장애인 != '4' then 1 else 0 end) 기본공제_장애인,
				sum(case when ye001.기본공제 = '1' and (ye001.가족관계 = '7' or ye001.가족관계 = '8') then 1 else 0 end) 기본공제_기타수급자_위탁아동,
				sum(case when ye001.경로우대 = '1' then 1 else 0 end) 추가공제_경로우대,
				sum(case when ye001.장애인 != '4' then 1 else 0 end) 추가공제_장애인,
				sum(case when ye001.부녀자 = '1' then 1 else 0 end) 추가공제_부녀자,
				sum(case when ye001.한부모 = '1' then 1 else 0 end) 추가공제_한부모,
				sum(case when ye001.자녀 = '1' then 1 else 0 end) 세액공제_자녀인원수,
				sum(case when ye001.자녀 = '1' and ye001.나이 <= 6 then 1 else 0 end) 세액공제_6세이하자녀수,
				sum(case when ye001.자녀 = '1' and ye001.출산입양 != '4' then 1 else 0 end) 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID
					AND ye000.사용자ID = ye001.사용자ID
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			]]>
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				sum(ye108.신용카드) 신용카드,
				sum(ye108.직불_선불카드) 직불_선불카드,
				sum(ye108.현금영수증) 현금영수증,
				sum(ye108.전통시장) 전통시장,
				sum(ye108.대중교통) 대중교통,
				sum(ye108.도서공연) 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye108 ye108 ON ye000.계약ID = ye108.계약ID
					AND ye000.사용자ID = ye108.사용자ID
					AND ye108.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				sum(case when ye104.구분코드 = 1 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code1,
				sum(case when ye104.구분코드 = 2 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code2,
				sum(case when ye104.구분코드 = 3 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code3,
				sum(case when ye104.구분코드 = 4 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code4,
				sum(case when ye104.구분코드 = 5 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code5,
				sum(case when ye104.구분코드 = 6 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code6,
				sum(case when ye104.구분코드 = 7 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code7,
				sum(case when ye104.구분코드 = 8 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code8,
				sum(case when ye104.구분코드 = 9 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye104 ye104 ON ye000.계약ID = ye104.계약ID
					AND ye000.사용자ID = ye104.사용자ID
					AND ye104.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			<![CDATA[
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				sum(case when ye001.가족관계 = '0' or ye001.나이 >= 65 or ye001.장애인 != '4' or ye402.의료비유형 = '3' then ye402.지출액 - ye402.차감금액 else 0 end) 특별세액공제_의료비_난임시술비등,
				sum(case when ye001.가족관계 != '0' and ye001.나이 < 65 and ye001.장애인 = '4' and ye402.의료비유형 != '3' then ye402.지출액 - ye402.차감금액 else 0 end) 특별세액공제_의료비_난임시술비등_그밖,
				sum(case when ye001.가족관계 = '0' and ye402.의료비유형 = '2' then ye402.지출액 - ye402.차감금액 else 0 end) 특별세액공제_의료비_안경구입_본인,
				sum(case when ye001.가족관계 != '0' and ye402.의료비유형 = '2' then ye402.지출액 - ye402.차감금액 else 0 end) 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID and ye000.사용자ID = ye001.사용자ID        
					INNER JOIN
				tbl_ye402 ye402 ON ye001.계약ID = ye402.계약ID
					AND ye001.사용자ID = ye402.사용자ID
					and ye001.부양가족ID = ye402.부양가족ID
					AND ye402.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			]]>
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			<![CDATA[
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무,
				null 기본공제_20세이하,
				null 기본공제_60세이상,
				null 기본공제_장애인,
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				sum(case when ye403.공제종류코드 = '1' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 본인교육비,
				count(distinct (case when ye403.공제종류코드 = '2' then ye001.부양가족ID end)) 취학전인원,
				sum(case when ye403.공제종류코드 = '2' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 취학전교육비,
				count(distinct (case when ye403.공제종류코드 = '3' then ye001.부양가족ID end)) 초중고인원,
				sum(case when ye403.공제종류코드 = '3' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 초중고교육비,
				sum(교복구입비 - 교복구입비_차감금액) 교복구입비,
				sum(체험학습비 - 체험학습비_차감금액) 체험학습비,
				count(distinct (case when ye403.공제종류코드 = '4' then ye001.부양가족ID end)) 대학생인원,
				sum(case when ye403.공제종류코드 = '4' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 대학생교육비,
				count(distinct (case when ye403.공제종류코드 = '4' then ye001.부양가족ID end)) 장애인인원,
				sum(case when ye403.공제종류코드 = '5' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID and ye000.사용자ID = ye001.사용자ID        
					INNER JOIN
				tbl_ye403 ye403 ON ye001.계약ID = ye403.계약ID
					AND ye001.사용자ID = ye403.사용자ID
					and ye001.부양가족ID = ye403.부양가족ID
					AND ye403.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			]]>
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			<![CDATA[
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				sum(case when ye404.기부코드 = '20' and ye404.기부명세_공제금액 <= 100000 then ye404.기부명세_공제금액 else 0 end) 정치기부금10만원이하,
				sum(case when ye404.기부코드 = '20' and ye404.기부명세_공제금액 > 100000 then ye404.기부명세_공제금액 else 0 end) 정치기부금10만원초과,
				sum(case when ye404.기부코드 = '10' then ye404.기부명세_공제금액 else 0 end) 법정기부금,
				sum(case when ye404.기부코드 = '42' then ye404.기부명세_공제금액 else 0 end) 우리사주기부금,
				sum(case when ye404.기부코드 = '40' then ye404.기부명세_공제금액 else 0 end) 종교단체외기부금,
				sum(case when ye404.기부코드 = '41' then ye404.기부명세_공제금액 else 0 end) 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID and ye000.사용자ID = ye001.사용자ID        
					INNER JOIN
				tbl_ye404 ye404 ON ye001.계약ID = ye404.계약ID
					AND ye001.사용자ID = ye404.사용자ID
					and ye001.부양가족ID = ye404.부양가족ID
					AND ye404.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			]]>
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				sum(case when ye051.보험료구분 = '1' then ye051.추가납입금액 else 0 end) 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					LEFT OUTER JOIN
				tbl_ye051 ye051 on ye000.계약ID = ye051.계약ID
					AND ye000.사용자ID = ye051.사용자ID and ye051.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				sum(case when ye052.보험료구분 = '1' then ye052.추가납입금액 else 0 end) 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye052 ye052 on ye000.계약ID = ye052.계약ID
					AND ye000.사용자ID = ye052.사용자ID and ye052.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				sum(case when ye101.차입구분 = '1' then 국세청자료 + 기타자료 - 차감금액 else 0 end) as 대출기관,
				sum(case when ye101.차입구분 = '2' then 국세청자료 + 기타자료 - 차감금액 else 0 end) as 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye101 ye101 ON ye000.계약ID = ye101.계약ID
					AND ye000.사용자ID = ye101.사용자ID and ye101.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				sum(case when (ye405.기부금종류코드 = '40' OR ye405.기부금종류코드 = '41') and ye405.기부년도 = '2013' then ye405.공제대상기부금 else 0 end) 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye405 ye405 ON ye000.계약ID = ye405.계약ID
					AND ye000.사용자ID = ye405.사용자ID
					AND ye405.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				sum(case when ye106.연금저축구분 = '21' then ye106.납입금액 - ye106.차감금액 else 0 end) 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye106 ye106 ON ye000.계약ID = ye106.계약ID
					AND ye000.사용자ID = ye106.사용자ID
					AND ye106.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				sum(ye201.국세청_납입금액 + ye201.기타_납입금액 - ye201.국세청_차감금액) 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye201 ye201 ON ye000.계약ID = ye201.계약ID
					AND ye000.사용자ID = ye201.사용자ID
					AND ye201.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				sum(ye107.납입금액 - ye107.차감금액) 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye107 ye107 ON ye000.계약ID = ye107.계약ID
					AND ye000.사용자ID = ye107.사용자ID
					AND ye107.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				sum(ye202.납입금액) 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye202 ye202 ON ye000.계약ID = ye202.계약ID
					AND ye000.사용자ID = ye202.사용자ID
					AND ye202.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				sum(ye203.납입금액) 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye203 ye203 ON ye000.계약ID = ye203.계약ID
					AND ye000.사용자ID = ye203.사용자ID
					AND ye203.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				sum(ye204.납입금액) 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye204 ye204 ON ye000.계약ID = ye204.계약ID
					AND ye000.사용자ID = ye204.사용자ID
					AND ye204.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				sum(ye109.납입금액 - ye109.차감금액) 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye109 ye109 ON ye000.계약ID = ye109.계약ID
					AND ye000.사용자ID = ye109.사용자ID
					AND ye109.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				sum(ye406.감면대상급여) 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye406 ye406 ON ye000.계약ID = ye406.계약ID
					AND ye000.사용자ID = ye406.사용자ID
					AND ye406.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				sum(case when ye301.퇴직연금구분코드 = '11' then ye301.납입금액 - ye301.차감금액 else 0 end) 세액공제_퇴직연금소득공제,
				sum(case when ye301.퇴직연금구분코드 = '12' then ye301.납입금액 - ye301.차감금액 else 0 end) 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye301 ye301 ON ye000.계약ID = ye301.계약ID
					AND ye000.사용자ID = ye301.사용자ID
					AND ye301.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				sum(ye302.납입금액 - ye302.차감금액) 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye302 ye302 ON ye000.계약ID = ye302.계약ID
					AND ye000.사용자ID = ye302.사용자ID
					AND ye302.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				sum(case when ye401.보험구분코드 = '1' then ye401.납입금액 - ye401.차감금액 else 0 end) 특별세액공제_보험료_보장성보험,
				sum(case when ye401.보험구분코드 = '2' then ye401.납입금액 - ye401.차감금액 else 0 end) 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye401 ye401 ON ye000.계약ID = ye401.계약ID
					AND ye000.사용자ID = ye401.사용자ID
					AND ye401.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				sum(금액) 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye501 ye501 ON ye000.계약ID = ye501.계약ID
					AND ye000.사용자ID = ye501.사용자ID
					AND ye501.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				sum(ye502.금액) 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye502 ye502 ON ye000.계약ID = ye502.계약ID
					AND ye000.사용자ID = ye502.사용자ID
					AND ye502.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				sum(ye503.세액공제금액) 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye503 ye503 ON ye000.계약ID = ye503.계약ID
					AND ye000.사용자ID = ye503.사용자ID
					AND ye503.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				sum(연간_월세액) 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye105 ye105 ON ye000.계약ID = ye105.계약ID
					AND ye000.사용자ID = ye105.사용자ID
					AND ye105.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			
			<!-- 
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
			<![CDATA[
      			sum(CASE WHEN IFNULL(m1, 'N') = 'Y' THEN (CASE WHEN m1금액 - 200000 < 0 THEN m1금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m2, 'N') = 'Y' THEN (CASE WHEN m2금액 - 200000 < 0 THEN m2금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m3, 'N') = 'Y' THEN (CASE WHEN m3금액 - 200000 < 0 THEN m3금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m4, 'N') = 'Y' THEN (CASE WHEN m4금액 - 200000 < 0 THEN m4금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m5, 'N') = 'Y' THEN (CASE WHEN m5금액 - 200000 < 0 THEN m5금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m6, 'N') = 'Y' THEN (CASE WHEN m6금액 - 200000 < 0 THEN m6금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m7, 'N') = 'Y' THEN (CASE WHEN m7금액 - 200000 < 0 THEN m7금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m8, 'N') = 'Y' THEN (CASE WHEN m8금액 - 200000 < 0 THEN m8금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m9, 'N') = 'Y' THEN (CASE WHEN m9금액 - 200000 < 0 THEN m9금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m10, 'N') = 'Y' THEN (CASE WHEN m10금액 - 200000 < 0 THEN m10금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m11, 'N') = 'Y' THEN (CASE WHEN m11금액 - 200000 < 0 THEN m11금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m12, 'N') = 'Y' THEN (CASE WHEN m12금액 - 200000 < 0 THEN m12금액 ELSE 200000 END) ELSE 0 END) as 차량비과세합계
      		]]>
			FROM
				tbl_ys000 ys000
			        INNER JOIN
			    tbl_ys030 ys030 ON ys000.계약ID = ys030.계약ID
			        INNER JOIN
			    tbl_ye000 ye000 ON ys030.계약ID = ye000.계약ID
			        AND ys030.사업장ID = ye000.사업장ID
			        INNER JOIN
			    tbl_emp emp ON ys000.biz_id = emp.biz_id
			        AND emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye002 ye002 ON ye000.계약ID = ye002.계약ID
					AND ye000.사용자ID = ye002.사용자ID
					INNER JOIN
				tbl_ye003 ye003 ON ye002.계약ID = ye003.계약ID
					AND ye002.사용자ID = ye003.사용자ID
					AND ye002.원천명세ID = ye003.원천명세ID
                    INNER JOIN
		    tbl_ye006 ye006 ON ye003.계약ID = ye006.계약ID
		        AND ye003.사용자ID = ye006.사용자ID
		        AND ye003.원천명세ID = ye006.원천명세ID
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID		
			-->	
		) t
			GROUP BY BIZ_ID , 사업장ID , 부서ID , EMP_NO , EMP_NAME , 개인식별번호 , 계약ID , 사용자ID

	</select>

	<!-- 입력현황 합계 -->
	<select id="reportDAO.getInputStatusSum" parameterClass="inputStatusVO" resultClass="inputStatusVO">
		select
			BIZ_ID AS bizId,
			사용자ID,
			SUM(급여) 급여,
			SUM(상여) 상여,
			SUM(인정상여) 인정상여,
			SUM(주식매수선택권행사이익) 주식매수선택권행사이익,
			SUM(우리사주조합인출금) 우리사주조합인출금,
			SUM(임원퇴직소득금액한도초과액) 임원퇴직소득금액한도초과액,
			SUM(직무발명보상금) AS 직무발명보상금,
			sum(국민연금보험료) 국민연금보험료,
			sum(공적연금) AS 공적연금,
			sum(건강보험료) 건강보험료,
			sum(고용보험료) 고용보험료,
			sum(기납부세액_소득세) 기납부세액_소득세,
			sum(기납부세액_지방소득세) 기납부세액_지방소득세,
			sum(기납부세액_농어촌특별세) 기납부세액_농어촌특별세,
			sum(M01) M01,
			sum(M02) M02,
			sum(M03) M03,
			sum(O01) O01,
			sum(Q01) Q01,
			sum(H08) H08,
			sum(H09) H09,
			sum(H10) H10,
			sum(G01) G01,
			sum(H11) H11,
			sum(H12) H12,
			sum(H13) H13,
			sum(H01) H01,
			sum(K01) K01,
			sum(S01) S01,
			sum(T01) T01,
			sum(Y02) Y02,
			sum(Y03) Y03,
			sum(Y04) Y04,
			sum(H05) H05,
			sum(I01) I01,
			sum(R10) R10,
			sum(H14) H14,
			sum(H15) H15,
			sum(T10) T10,
			sum(T11) T11,
			sum(T12) T12,
			sum(T20) T20,
			sum(H16) H16,
			sum(R11) R11,
			sum(H06) H06,
			sum(H07) H07,
			sum(Y22) Y22,
			sum(T13) T13,
			sum(H17) H17,
			sum(U01) U01,
			max(기본공제_배우자유무) 기본공제_배우자유무, 
			sum(기본공제_20세이하) 기본공제_20세이하, 
			sum(기본공제_60세이상) 기본공제_60세이상, 
			sum(기본공제_장애인) 기본공제_장애인, 
			sum(기본공제_기타수급자_위탁아동) 기본공제_기타수급자_위탁아동, 
			sum(추가공제_경로우대) 추가공제_경로우대, 
			sum(추가공제_장애인) 추가공제_장애인, 
			sum(추가공제_부녀자) 추가공제_부녀자, 
			sum(추가공제_한부모) 추가공제_한부모, 
			sum(세액공제_자녀인원수) 세액공제_자녀인원수, 
			sum(세액공제_6세이하자녀수) 세액공제_6세이하자녀수, 
			sum(세액공제_출산_입양자녀수) 세액공제_출산_입양자녀수,
			sum(신용카드) 신용카드,
			sum(직불_선불카드) 직불_선불카드,
			sum(현금영수증) 현금영수증,
			sum(전통시장) 전통시장,
			sum(대중교통) 대중교통,
			sum(도서공연) 도서공연,
			sum(특별소득공제_주택자금1) 특별소득공제_주택자금1,
			sum(특별소득공제_주택자금2) 특별소득공제_주택자금2,
			sum(특별소득공제_주택자금3) 특별소득공제_주택자금3,
			sum(특별소득공제_주택자금4) 특별소득공제_주택자금4,
			sum(특별소득공제_주택자금5) 특별소득공제_주택자금5,
			sum(특별소득공제_주택자금6) 특별소득공제_주택자금6,
			sum(특별소득공제_주택자금7) 특별소득공제_주택자금7,
			sum(특별소득공제_주택자금8) 특별소득공제_주택자금8,
			sum(특별소득공제_주택자금9) 특별소득공제_주택자금9,
			sum(특별세액공제_의료비_난임시술비등) 특별세액공제_의료비_난임시술비등,
			sum(특별세액공제_의료비_난임시술비등_그밖) 특별세액공제_의료비_난임시술비등_그밖,
			sum(특별세액공제_의료비_안경구입_본인) 특별세액공제_의료비_안경구입_본인,
			sum(특별세액공제_의료비_안경구입_그밖) 특별세액공제_의료비_안경구입_그밖,
			sum(본인교육비) 본인교육비,
			sum(취학전인원) 취학전인원,
			sum(취학전교육비) 취학전교육비,
			sum(초중고인원) 초중고인원,
			sum(초중고교육비) 초중고교육비,
			sum(교복구입비) 교복구입비,
			sum(체험학습비) 체험학습비,
			sum(대학생인원) 대학생인원,
			sum(대학생교육비) 대학생교육비,
			sum(장애인인원) 장애인인원,
			sum(장애인교육비) 장애인교육비,
			sum(정치기부금10만원이하) 정치기부금10만원이하,
			sum(정치기부금10만원초과) 정치기부금10만원초과,
			sum(법정기부금) 법정기부금,
			sum(우리사주기부금) 우리사주기부금,
			sum(종교단체외기부금) 종교단체외기부금,
			sum(종교단체기부금) 종교단체기부금,
			sum(연금보험료공제_국민연금_지역) 연금보험료공제_국민연금_지역,
			sum(건강보험료_지역) 건강보험료_지역,
			sum(대출기관) 대출기관,
			sum(거주자) 거주자,
			sum(기부금_이월분) 기부금_이월분,
			sum(개인연금저축납입액) 개인연금저축납입액,
			sum(소기업소상공인공제부금) 소기업소상공인공제부금,
			sum(주택마련저축불입액) 주택마련저축불입액,
			sum(투자조합출자등투자금액) 투자조합출자등투자금액,
			sum(우리사주조합출연금) 우리사주조합출연금,
			sum(고용유지중소기업) 고용유지중소기업,
			sum(장기집합투자증권저축) 장기집합투자증권저축,
			sum(세액감면_소득세법) 세액감면_소득세법,			
			sum(세액공제_퇴직연금소득공제) 세액공제_퇴직연금소득공제,
			sum(세액공제_과학기술인공제) 세액공제_과학기술인공제,
			sum(세액공제_연금저축) 세액공제_연금저축,
			sum(특별세액공제_보험료_보장성보험) 특별세액공제_보험료_보장성보험,
			sum(특별세액공제_보험료_장애인전용보장성보험) 특별세액공제_보험료_장애인전용보장성보험,
			sum(납세조합공제) 납세조합공제,
			sum(주택차입금) 주택차입금,
			sum(외국납부) 외국납부,
			sum(연간_월세액) 연간_월세액,
			sum(차량비과세합계) 차량비과세합계
		from (
			SELECT 
	<![CDATA[
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				ye000.연말정산분납여부,
				concat(ys000.FEB_YEAR ,'/13') 정산년월,
				max(CASE               
				  WHEN SUBSTRING(emp.JOIN_DATE,1,4) = ys000.FEB_YEAR THEN emp.JOIN_DATE                 
				  WHEN SUBSTRING(emp.JOIN_DATE,1,4) < ys000.FEB_YEAR THEN CONCAT(ys000.FEB_YEAR,'0101')              
				END) AS 근무시작일,
	          	max(CASE 
          		   WHEN emp.LEAVE_DATE = '0' THEN CONCAT(ys000.FEB_YEAR,'1231')
    			   WHEN emp.LEAVE_DATE = '00000000' THEN CONCAT(ys000.FEB_YEAR,'1231')
    			   WHEN emp.LEAVE_DATE = '00000101' THEN CONCAT(ys000.FEB_YEAR,'1231')
            	   WHEN IFNULL(emp.LEAVE_DATE,'') = '' THEN CONCAT(ys000.FEB_YEAR,'1231')
            	   WHEN SUBSTRING(emp.LEAVE_DATE,1,4) > ys000.FEB_YEAR THEN CONCAT(ys000.FEB_YEAR,'1231') 
            	   ELSE emp.LEAVE_DATE
          		END) AS 근무종료일,
				SUM((IFNULL(ye003.급여,0)+IFNULL(ye003.비과세한도초과액,0)-IFNULL(K.차량비과세, 0))) 급여,
				SUM(ye003.상여) 상여,
				SUM(ye003.인정상여) 인정상여,
				SUM(ye003.주식매수선택권행사이익) 주식매수선택권행사이익,
				SUM(ye003.우리사주조합인출금) 우리사주조합인출금,
				SUM(ye003.임원퇴직소득금액한도초과액) 임원퇴직소득금액한도초과액,
				SUM(ye003.직무발명보상금) AS 직무발명보상금,
				sum(ye003.국민연금보험료) 국민연금보험료,
				sum(ye003.공무원연금 + ye003.군인연금 + ye003.사립학교교직원연금 + ye003.별정우체국연금) AS 공적연금,
				sum(ye003.건강보험료) 건강보험료,
				sum(ye003.고용보험료) 고용보험료,
				sum(ye003.소득세) 기납부세액_소득세,
				sum(ye003.지방소득세) 기납부세액_지방소득세,
				sum(ye003.농어촌특별세) 기납부세액_농어촌특별세,
				sum(ye003.M01) M01,
				sum(ye003.M02) M02,
				sum(ye003.M03) M03,
				sum(ye003.O01) O01,
				sum(ye003.Q01) Q01,
				sum(ye003.H08) H08,
				sum(ye003.H09) H09,
				sum(ye003.H10) H10,
				sum(ye003.G01) G01,
				sum(ye003.H11) H11,
				sum(ye003.H12) H12,
				sum(ye003.H13) H13,
				sum(ye003.H01) H01,
				sum(ye003.K01) K01,
				sum(ye003.S01) S01,
				sum(ye003.T01) T01,
				sum(ye003.Y02) Y02,
				sum(ye003.Y03) Y03,
				sum(ye003.Y04) Y04,
				sum(ye003.H05) H05,
				sum(ye003.I01) I01,
				sum(ye003.R10) R10,
				sum(ye003.H14) H14,
				sum(ye003.H15) H15,
				sum(ye003.T10) T10,
				sum(ye003.T11) T11,
				sum(ye003.T12) T12,
				sum(ye003.T20) T20,
				sum(ye003.H16) H16,
				sum(ye003.R11) R11,
				sum(ye003.H06) H06,
				sum(ye003.H07) H07,
				sum(ye003.Y22) Y22,
				sum(ye003.T13) T13,
				sum(ye003.H17) H17,
				sum(ye003.U01) U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				sum(k.차량비과세) AS 차량비과세합계 
	]]>
			FROM
				tbl_ys000 ys000
			     INNER JOIN tbl_ys030 ys030 
			      ON ys000.계약ID = ys030.계약ID
			     INNER JOIN tbl_ye000 ye000 
			      ON ys030.계약ID = ye000.계약ID AND ys030.사업장ID = ye000.사업장ID
			     INNER JOIN tbl_emp emp 
			      ON ys000.biz_id = emp.biz_id AND emp.user_id = ye000.사용자ID
			     INNER JOIN tbl_ye002 ye002 
			      ON ye000.계약ID = ye002.계약ID AND ye000.사용자ID = ye002.사용자ID
			     INNER JOIN tbl_ye003 ye003 
			      ON ye002.계약ID = ye003.계약ID AND ye002.사용자ID = ye003.사용자ID AND ye002.원천명세ID = ye003.원천명세ID
			     LEFT OUTER JOIN (
			        	SELECT  T1.계약ID, T1.사용자ID,
						       (CASE WHEN T1.M1 = 'Y' THEN CASE WHEN IFNULL(T1.M1금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M1금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M2 = 'Y' THEN CASE WHEN IFNULL(T1.M2금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M2금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M3 = 'Y' THEN CASE WHEN IFNULL(T1.M3금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M3금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M4 = 'Y' THEN CASE WHEN IFNULL(T1.M4금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M4금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M5 = 'Y' THEN CASE WHEN IFNULL(T1.M5금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M5금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M6 = 'Y' THEN CASE WHEN IFNULL(T1.M6금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M6금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M7 = 'Y' THEN CASE WHEN IFNULL(T1.M7금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M7금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M8 = 'Y' THEN CASE WHEN IFNULL(T1.M8금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M8금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M9 = 'Y' THEN CASE WHEN IFNULL(T1.M9금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M9금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M10 = 'Y' THEN CASE WHEN IFNULL(T1.M10금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M10금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M11 = 'Y' THEN CASE WHEN IFNULL(T1.M11금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M11금액, 0) END ELSE 0 END +
						        CASE WHEN T1.M12 = 'Y' THEN CASE WHEN IFNULL(T1.M12금액, 0) >= 200000 THEN 200000 ELSE IFNULL(T1.M12금액, 0) END ELSE 0 END) 차량비과세
						FROM  TBL_YE006 T1
						WHERE T1.계약ID = #계약ID#
        		) K
        		ON ye000.계약ID = K.계약ID AND ye000.사용자ID = K.사용자ID 
			WHERE ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			<![CDATA[
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				(case when sum(case when ye001.기본공제 = '1' and ye001.가족관계 = '3' then 1 else 0 end) > 0 then 'O' else 'X' end) 기본공제_배우자유무,
				sum(case when ye001.기본공제 = '1' and ye001.나이 <= 20 then 1 else 0 end) 기본공제_20세이하,
				sum(case when ye001.기본공제 = '1' and ye001.나이 >= 60 then 1 else 0 end) 기본공제_60세이상,
				sum(case when ye001.기본공제 = '1' and ye001.장애인 != '4' then 1 else 0 end) 기본공제_장애인,
				sum(case when ye001.기본공제 = '1' and (ye001.가족관계 = '7' or ye001.가족관계 = '8') then 1 else 0 end) 기본공제_기타수급자_위탁아동,
				sum(case when ye001.경로우대 = '1' then 1 else 0 end) 추가공제_경로우대,
				sum(case when ye001.장애인 != '4' then 1 else 0 end) 추가공제_장애인,
				sum(case when ye001.부녀자 = '1' then 1 else 0 end) 추가공제_부녀자,
				sum(case when ye001.한부모 = '1' then 1 else 0 end) 추가공제_한부모,
				sum(case when ye001.자녀 = '1' then 1 else 0 end) 세액공제_자녀인원수,
				sum(case when ye001.자녀 = '1' and ye001.나이 <= 6 then 1 else 0 end) 세액공제_6세이하자녀수,
				sum(case when ye001.자녀 = '1' and ye001.출산입양 != '4' then 1 else 0 end) 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID
					AND ye000.사용자ID = ye001.사용자ID
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			]]>
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				sum(ye108.신용카드) 신용카드,
				sum(ye108.직불_선불카드) 직불_선불카드,
				sum(ye108.현금영수증) 현금영수증,
				sum(ye108.전통시장) 전통시장,
				sum(ye108.대중교통) 대중교통,
				sum(ye108.도서공연) 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye108 ye108 ON ye000.계약ID = ye108.계약ID
					AND ye000.사용자ID = ye108.사용자ID
					AND ye108.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				sum(case when ye104.구분코드 = 1 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code1,
				sum(case when ye104.구분코드 = 2 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code2,
				sum(case when ye104.구분코드 = 3 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code3,
				sum(case when ye104.구분코드 = 4 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code4,
				sum(case when ye104.구분코드 = 5 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code5,
				sum(case when ye104.구분코드 = 6 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code6,
				sum(case when ye104.구분코드 = 7 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code7,
				sum(case when ye104.구분코드 = 8 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code8,
				sum(case when ye104.구분코드 = 9 then 국세청자료 + 기타자료 - 차감금액 else 0 end) code9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye104 ye104 ON ye000.계약ID = ye104.계약ID
					AND ye000.사용자ID = ye104.사용자ID
					AND ye104.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			<![CDATA[
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				sum(case when ye001.가족관계 = '0' or ye001.나이 >= 65 or ye001.장애인 != '4' or ye402.의료비유형 = '3' then ye402.지출액 - ye402.차감금액 else 0 end) 특별세액공제_의료비_난임시술비등,
				sum(case when ye001.가족관계 != '0' and ye001.나이 < 65 and ye001.장애인 = '4' and ye402.의료비유형 != '3' then ye402.지출액 - ye402.차감금액 else 0 end) 특별세액공제_의료비_난임시술비등_그밖,
				sum(case when ye001.가족관계 = '0' and ye402.의료비유형 = '2' then ye402.지출액 - ye402.차감금액 else 0 end) 특별세액공제_의료비_안경구입_본인,
				sum(case when ye001.가족관계 != '0' and ye402.의료비유형 = '2' then ye402.지출액 - ye402.차감금액 else 0 end) 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID and ye000.사용자ID = ye001.사용자ID        
					INNER JOIN
				tbl_ye402 ye402 ON ye001.계약ID = ye402.계약ID
					AND ye001.사용자ID = ye402.사용자ID
					and ye001.부양가족ID = ye402.부양가족ID
					AND ye402.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			]]>
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			<![CDATA[
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무,
				null 기본공제_20세이하,
				null 기본공제_60세이상,
				null 기본공제_장애인,
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				sum(case when ye403.공제종류코드 = '1' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 본인교육비,
				count(distinct (case when ye403.공제종류코드 = '2' then ye001.부양가족ID end)) 취학전인원,
				sum(case when ye403.공제종류코드 = '2' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 취학전교육비,
				count(distinct (case when ye403.공제종류코드 = '3' then ye001.부양가족ID end)) 초중고인원,
				sum(case when ye403.공제종류코드 = '3' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 초중고교육비,
				sum(교복구입비 - 교복구입비_차감금액) 교복구입비,
				sum(체험학습비 - 체험학습비_차감금액) 체험학습비,
				count(distinct (case when ye403.공제종류코드 = '4' then ye001.부양가족ID end)) 대학생인원,
				sum(case when ye403.공제종류코드 = '4' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 대학생교육비,
				count(distinct (case when ye403.공제종류코드 = '4' then ye001.부양가족ID end)) 장애인인원,
				sum(case when ye403.공제종류코드 = '5' then 공납금 + 교복구입비 + 체험학습비 - 공납금_차감금액 - 교복구입비_차감금액 - 체험학습비_차감금액 else 0 end) 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID and ye000.사용자ID = ye001.사용자ID        
					INNER JOIN
				tbl_ye403 ye403 ON ye001.계약ID = ye403.계약ID
					AND ye001.사용자ID = ye403.사용자ID
					and ye001.부양가족ID = ye403.부양가족ID
					AND ye403.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			]]>
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			<![CDATA[
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				sum(case when ye404.기부코드 = '20' and ye404.기부명세_공제금액 <= 100000 then ye404.기부명세_공제금액 else 0 end) 정치기부금10만원이하,
				sum(case when ye404.기부코드 = '20' and ye404.기부명세_공제금액 > 100000 then ye404.기부명세_공제금액 else 0 end) 정치기부금10만원초과,
				sum(case when ye404.기부코드 = '10' then ye404.기부명세_공제금액 else 0 end) 법정기부금,
				sum(case when ye404.기부코드 = '42' then ye404.기부명세_공제금액 else 0 end) 우리사주기부금,
				sum(case when ye404.기부코드 = '40' then ye404.기부명세_공제금액 else 0 end) 종교단체외기부금,
				sum(case when ye404.기부코드 = '41' then ye404.기부명세_공제금액 else 0 end) 종교단체기부금,
				null 연금보험료공제_국민연금_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye001 ye001 ON ye000.계약ID = ye001.계약ID and ye000.사용자ID = ye001.사용자ID        
					INNER JOIN
				tbl_ye404 ye404 ON ye001.계약ID = ye404.계약ID
					AND ye001.사용자ID = ye404.사용자ID
					and ye001.부양가족ID = ye404.부양가족ID
					AND ye404.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			]]>
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				sum(case when ye051.보험료구분 = '1' then ye051.추가납입금액 else 0 end) 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					LEFT OUTER JOIN
				tbl_ye051 ye051 on ye000.계약ID = ye051.계약ID
					AND ye000.사용자ID = ye051.사용자ID and ye051.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				sum(case when ye052.보험료구분 = '1' then ye052.추가납입금액 else 0 end) 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye052 ye052 on ye000.계약ID = ye052.계약ID
					AND ye000.사용자ID = ye052.사용자ID and ye052.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				sum(case when ye101.차입구분 = '1' then 국세청자료 + 기타자료 - 차감금액 else 0 end) as 대출기관,
				sum(case when ye101.차입구분 = '2' then 국세청자료 + 기타자료 - 차감금액 else 0 end) as 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye101 ye101 ON ye000.계약ID = ye101.계약ID
					AND ye000.사용자ID = ye101.사용자ID and ye101.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				sum(case when (ye405.기부금종류코드 = '40' OR ye405.기부금종류코드 = '41') and ye405.기부년도 = '2013' then ye405.공제대상기부금 else 0 end) 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye405 ye405 ON ye000.계약ID = ye405.계약ID
					AND ye000.사용자ID = ye405.사용자ID
					AND ye405.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				sum(case when ye106.연금저축구분 = '21' then ye106.납입금액 - ye106.차감금액 else 0 end) 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye106 ye106 ON ye000.계약ID = ye106.계약ID
					AND ye000.사용자ID = ye106.사용자ID
					AND ye106.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				sum(ye201.국세청_납입금액 + ye201.기타_납입금액 - ye201.국세청_차감금액) 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye201 ye201 ON ye000.계약ID = ye201.계약ID
					AND ye000.사용자ID = ye201.사용자ID
					AND ye201.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				sum(ye107.납입금액 - ye107.차감금액) 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye107 ye107 ON ye000.계약ID = ye107.계약ID
					AND ye000.사용자ID = ye107.사용자ID
					AND ye107.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				sum(ye202.납입금액) 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye202 ye202 ON ye000.계약ID = ye202.계약ID
					AND ye000.사용자ID = ye202.사용자ID
					AND ye202.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				sum(ye203.납입금액) 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye203 ye203 ON ye000.계약ID = ye203.계약ID
					AND ye000.사용자ID = ye203.사용자ID
					AND ye203.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				sum(ye204.납입금액) 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye204 ye204 ON ye000.계약ID = ye204.계약ID
					AND ye000.사용자ID = ye204.사용자ID
					AND ye204.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				sum(ye109.납입금액 - ye109.차감금액) 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye109 ye109 ON ye000.계약ID = ye109.계약ID
					AND ye000.사용자ID = ye109.사용자ID
					AND ye109.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				sum(ye406.감면대상급여) 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye406 ye406 ON ye000.계약ID = ye406.계약ID
					AND ye000.사용자ID = ye406.사용자ID
					AND ye406.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				sum(case when ye301.퇴직연금구분코드 = '11' then ye301.납입금액 - ye301.차감금액 else 0 end) 세액공제_퇴직연금소득공제,
				sum(case when ye301.퇴직연금구분코드 = '12' then ye301.납입금액 - ye301.차감금액 else 0 end) 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye301 ye301 ON ye000.계약ID = ye301.계약ID
					AND ye000.사용자ID = ye301.사용자ID
					AND ye301.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				sum(ye302.납입금액 - ye302.차감금액) 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye302 ye302 ON ye000.계약ID = ye302.계약ID
					AND ye000.사용자ID = ye302.사용자ID
					AND ye302.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				sum(case when ye401.보험구분코드 = '1' then ye401.납입금액 - ye401.차감금액 else 0 end) 특별세액공제_보험료_보장성보험,
				sum(case when ye401.보험구분코드 = '2' then ye401.납입금액 - ye401.차감금액 else 0 end) 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye401 ye401 ON ye000.계약ID = ye401.계약ID
					AND ye000.사용자ID = ye401.사용자ID
					AND ye401.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				sum(금액) 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye501 ye501 ON ye000.계약ID = ye501.계약ID
					AND ye000.사용자ID = ye501.사용자ID
					AND ye501.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				sum(ye502.금액) 주택차입금,
				null 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye502 ye502 ON ye000.계약ID = ye502.계약ID
					AND ye000.사용자ID = ye502.사용자ID
					AND ye502.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				sum(ye503.세액공제금액) 외국납부,
				null 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye503 ye503 ON ye000.계약ID = ye503.계약ID
					AND ye000.사용자ID = ye503.사용자ID
					AND ye503.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, 
				null AS 직무발명보상금, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				sum(연간_월세액) 연간_월세액,
				null 차량비과세합계
			FROM
				tbl_emp emp
					INNER JOIN
				tbl_ye000 ye000 ON emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye105 ye105 ON ye000.계약ID = ye105.계약ID
					AND ye000.사용자ID = ye105.사용자ID
					AND ye105.사용여부 = '1'
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID
			
			<!--
			union all
			SELECT 
				emp.BIZ_ID,
				ye000.사업장ID,
				ye000.부서ID,
				emp.EMP_NO,
				emp.EMP_NAME,
				ye000.개인식별번호,
				ye000.계약ID,
				ye000.사용자ID,
				null 연말정산분납여부,
				null 정산년월,
				null 근무시작일,
				null 근무종료일,
				null 급여, null 상여, null 인정상여, null 주식매수선택권행사이익, null 우리사주조합인출금, null 임원퇴직소득금액한도초과액, null 국민연금보험료, 
				null 공적연금, null 건강보험료, null 고용보험료, null 기납부세액_소득세, null 기납부세액_지방소득세, null 기납부세액_농어촌특별세, 
				null M01, null M02, null M03, null O01, null Q01, null H08, null H09, null H10, null G01, null H11, null H12, null H13, null H01, 
				null K01, null S01, null T01, null Y02, null Y03, null Y04, null H05, null I01, null R10, null H14, null H15, 
				null T10, null T11, null T12, null T20, null H16, null R11, null H06, null H07, null Y22, null T13, null H17, null U01,
				null 기본공제_배우자유무, 
				null 기본공제_20세이하, 
				null 기본공제_60세이상, 
				null 기본공제_장애인, 
				null 기본공제_기타수급자_위탁아동, 
				null 추가공제_경로우대, 
				null 추가공제_장애인, 
				null 추가공제_부녀자, 
				null 추가공제_한부모, 
				null 세액공제_자녀인원수, 
				null 세액공제_6세이하자녀수, 
				null 세액공제_출산_입양자녀수,
				null 신용카드,
				null 직불_선불카드,
				null 현금영수증,
				null 전통시장,
				null 대중교통,
				null 도서공연,
				null 특별소득공제_주택자금1,
				null 특별소득공제_주택자금2,
				null 특별소득공제_주택자금3,
				null 특별소득공제_주택자금4,
				null 특별소득공제_주택자금5,
				null 특별소득공제_주택자금6,
				null 특별소득공제_주택자금7,
				null 특별소득공제_주택자금8,
				null 특별소득공제_주택자금9,
				null 특별세액공제_의료비_난임시술비등,
				null 특별세액공제_의료비_난임시술비등_그밖,
				null 특별세액공제_의료비_안경구입_본인,
				null 특별세액공제_의료비_안경구입_그밖,
				null 본인교육비,
				null 취학전인원,
				null 취학전교육비,
				null 초중고인원,
				null 초중고교육비,
				null 교복구입비,
				null 체험학습비,
				null 대학생인원,
				null 대학생교육비,
				null 장애인인원,
				null 장애인교육비,
				null 정치기부금10만원이하,
				null 정치기부금10만원초과,
				null 법정기부금,
				null 우리사주기부금,
				null 종교단체외기부금,
				null 종교단체기부금,
				null 국민연금보험료_지역,
				null 건강보험료_지역,
				null 대출기관,
				null 거주자,
				null 기부금_이월분,
				null 개인연금저축납입액,
				null 소기업소상공인공제부금,
				null 주택마련저축불입액,
				null 투자조합출자등투자금액,
				null 우리사주조합출연금,
				null 고용유지중소기업,
				null 장기집합투자증권저축,
				null 세액감면_소득세법,
				null 세액공제_퇴직연금소득공제,
				null 세액공제_과학기술인공제,
				null 세액공제_연금저축,
				null 특별세액공제_보험료_보장성보험,
				null 특별세액공제_보험료_장애인전용보장성보험,
				null 납세조합공제,
				null 주택차입금,
				null 외국납부,
				null 연간_월세액,
			<![CDATA[
      			sum(CASE WHEN IFNULL(m1, 'N') = 'Y' THEN (CASE WHEN m1금액 - 200000 < 0 THEN m1금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m2, 'N') = 'Y' THEN (CASE WHEN m2금액 - 200000 < 0 THEN m2금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m3, 'N') = 'Y' THEN (CASE WHEN m3금액 - 200000 < 0 THEN m3금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m4, 'N') = 'Y' THEN (CASE WHEN m4금액 - 200000 < 0 THEN m4금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m5, 'N') = 'Y' THEN (CASE WHEN m5금액 - 200000 < 0 THEN m5금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m6, 'N') = 'Y' THEN (CASE WHEN m6금액 - 200000 < 0 THEN m6금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m7, 'N') = 'Y' THEN (CASE WHEN m7금액 - 200000 < 0 THEN m7금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m8, 'N') = 'Y' THEN (CASE WHEN m8금액 - 200000 < 0 THEN m8금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m9, 'N') = 'Y' THEN (CASE WHEN m9금액 - 200000 < 0 THEN m9금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m10, 'N') = 'Y' THEN (CASE WHEN m10금액 - 200000 < 0 THEN m10금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m11, 'N') = 'Y' THEN (CASE WHEN m11금액 - 200000 < 0 THEN m11금액 ELSE 200000 END) ELSE 0 END)
		          + (CASE WHEN IFNULL(m12, 'N') = 'Y' THEN (CASE WHEN m12금액 - 200000 < 0 THEN m12금액 ELSE 200000 END) ELSE 0 END) as 차량비과세합계
      		]]>
			FROM
				tbl_ys000 ys000
			        INNER JOIN
			    tbl_ys030 ys030 ON ys000.계약ID = ys030.계약ID
			        INNER JOIN
			    tbl_ye000 ye000 ON ys030.계약ID = ye000.계약ID
			        AND ys030.사업장ID = ye000.사업장ID
			        INNER JOIN
			    tbl_emp emp ON ys000.biz_id = emp.biz_id
			        AND emp.user_id = ye000.사용자ID
					INNER JOIN
				tbl_ye002 ye002 ON ye000.계약ID = ye002.계약ID
					AND ye000.사용자ID = ye002.사용자ID
					INNER JOIN
				tbl_ye003 ye003 ON ye002.계약ID = ye003.계약ID
					AND ye002.사용자ID = ye003.사용자ID
					AND ye002.원천명세ID = ye003.원천명세ID
                    INNER JOIN
		    tbl_ye006 ye006 ON ye003.계약ID = ye006.계약ID
		        AND ye003.사용자ID = ye006.사용자ID
		        AND ye003.원천명세ID = ye006.원천명세ID
			WHERE
				ye000.사용여부 = '1'
			AND emp.EMP_TYPE IN ('1','2','3')
			AND emp.BIZ_ID = #bizId#
		    AND ye000.계약ID = #계약ID#
			<isNotNull property="사업장ID">
				<isNotEmpty property="사업장ID">
					AND ye000.사업장ID		= #사업장ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="부서ID">
				<isNotEmpty property="부서ID">
					AND ye000.부서ID		= #부서ID#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="성명">
				<isNotEmpty property="성명">
					AND emp.EMP_NAME LIKE CONCAT('%', #성명#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="사번">
				<isNotEmpty property="사번">
					AND emp.EMP_NO LIKE CONCAT('%', #사번#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="직책">
				<isNotEmpty property="직책">
					AND emp.POSITION_NAME LIKE CONCAT('%', #직책#, '%')
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="근무상태">
			    <isNotEmpty property="근무상태">
				    <isEqual property="근무상태"  compareValue="1">
						AND   (EMP.LEAVE_DATE IS NULL OR EMP.LEAVE_DATE = '' OR EMP.LEAVE_DATE = '0')
					</isEqual>
				    <isEqual property="근무상태"  compareValue="2">
						AND   (EMP.LEAVE_DATE IS NOT NULL AND EMP.LEAVE_DATE != '' AND LEAVE_DATE != '0')  
					</isEqual>
				</isNotEmpty>
			</isNotNull>
			GROUP BY emp.BIZ_ID , ye000.사업장ID , ye000.부서ID , emp.EMP_NO , emp.EMP_NAME , ye000.개인식별번호 , ye000.계약ID , ye000.사용자ID	
			-->					
		) t
			GROUP BY BIZ_ID, 계약ID

	</select>

</sqlMap>


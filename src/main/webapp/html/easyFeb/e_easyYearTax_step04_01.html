<link rel="stylesheet" type="text/css" href="/css/material-icons.min.css">
<link rel="stylesheet" type="text/css" href="/css/yearTax_common.css">
	<div id="yearTax_wrap" class="yearTax easy">
		<div class="container">
			<div class="location"><span class="loc_main NanumSquare_R">연말정산 >  </span><span class="loc_sub NanumSquare_R">추가서류 제출</span></div>
			
			<div class="process_wrap mask">
				<div class="stepBar"> 
					<div class="box clear">
						<div class="process-step NanumSquare_R">
							<div class="bar"><span class="line"></span><span class="no">1</span></div>
							<div class="process-panel">
									<span class="icon"></span>
									<span class="name NanumRound">소득확인</span>	
							</div>
							<div class="process-arrow"></div>
						</div>
					</div>
					<div class="box clear">
						<div class="process-step NanumSquare_R">
							<div class="bar"><span class="line"></span><span class="no">2</span></div>
							<div class="process-panel">
								<span class="icon"></span>
								<span class="name NanumRound">부양가족</span>
							</div>
							<div class="process-arrow"></div>
						</div>
					</div>
					<div class="box clear">
						<div class="process-step NanumSquare_R">
							<div class="bar"><span class="line"></span><span class="no">3</span></div>
							<div class="process-panel">
								<span class="icon"></span>
								<span class="name NanumRound">지출내역 확인</span>
							</div>
							<div class="process-arrow"></div>
						</div>
					</div>
					<div class="box current">
						<div class="process-step NanumSquare_R">
							<div class="bar"><span class="line"></span><span class="no">4</span></div>
							<div class="process-panel">
								<span class="icon"></span>
								<span class="name NanumRound">추가서류 제출</span>
							</div>
							<div class="process-arrow"></div>
						</div>
					</div>
					<div class="box">
						<div class="process-step NanumSquare_R">
							<div class="bar"><span class="line"></span><span class="no">5</span></div>
							<div class="process-panel">
								<span class="icon"></span>
								<span class="name NanumRound">연말정산 요약</span>
							</div>
						</div>
					</div>
				</div>
			</div> <!--  process_wrap -->
			
			<div class="contents">
				<div class="sub_item NanumSquare_R">
					<div class="item_btnlist">
						<a class="btn_type" onclick="javascript:fn_addFile('F100')"><span class="txt"><span class="row_tit">부양가족</span><span class="row_sub_tit NanumRound">인적공제</span></span><span class="val"><span class="count" id="부양가족건수"></span><span class="unit">건</span></span></a>
						<a class="btn_type" onclick="javascript:fn_addFile('F200')"><span class="txt"><span class="row_tit">보험료</span><span class="row_sub_tit NanumRound">보장성/장애인</span></span><span class="val"><span class="count" id="보험료건수"></span><span class="unit">건</span></span></a>
						<a class="btn_type" onclick="javascript:fn_addFile('F600')"><span class="txt"><span class="row_tit">의료비</span><span class="row_sub_tit NanumRound">안경/난임</span></span><span class="val"><span class="count" id="의료비건수"></span><span class="unit">건</span></span></a>
						<a class="btn_type" onclick="javascript:fn_addFile('F800')"><span class="txt"><span class="row_tit">교육비</span><span class="row_sub_tit NanumRound">교복/체험학습/방과후</span></span><span class="val"><span class="count" id="교육비건수"></span><span class="unit">건</span></span></a>
						<a class="btn_type" onclick="javascript:fn_addFile('F700')"><span class="txt"><span class="row_tit">기부금</span><span class="row_sub_tit NanumRound"></span></span><span class="val"><span class="count" id="기부금건수"></span><span class="unit">건</span></span></a>
						<a class="btn_type" onclick="javascript:fn_addFile('F500')"><span class="txt"><span class="row_tit">신용카드</span><span class="row_sub_tit NanumRound"></span></span><span class="val"><span class="count" id="신용카드건수"></span><span class="unit">건</span></span></a>
						<a class="btn_type" onclick="javascript:fn_addFile('F900')"><span class="txt"><span class="row_tit">종(전) 근무지</span><span class="row_sub_tit NanumRound"></span></span><span class="val"><span class="count" id="종전근무지건수"></span><span class="unit">건</span></span></a>
						<a class="btn_type" onclick="javascript:fn_addFile('F300')"><span class="txt"><span class="row_tit">주택자금</span><span class="row_sub_tit NanumRound"></span></span><span class="val"><span class="count" id="주택자금건수"></span><span class="unit">건</span></span></a>
						<a class="btn_type" onclick="javascript:fn_addFile('F400')"><span class="txt"><span class="row_tit">월세액</span><span class="row_sub_tit NanumRound"></span></span><span class="val"><span class="count" id="월세액건수"></span><span class="unit">건</span></span></a>
						<a class="btn_type" onclick="javascript:fn_addFile('F000')"><span class="txt"><span class="row_tit">기타 영수증</span><span class="row_sub_tit NanumRound"></span></span><span class="val"><span class="count" id="기타영수증건수"></span><span class="unit">건</span></span></a>
					</div>
				</div>
				
			</div> <!--  contents -->
			
			<div class="group_btns foot NanumSquare_R">
				<a class="btn_type type1">＜  이전</a>
				<a class="btn_type type3">다음 ＞</a>
			</div>
		</div> <!--  container -->
		
		<div class="layerPop_wrap">
			<div class="popup_bg small">
			
				<div class="popup_tit">
					<div class="popup_close"><a class="btn_type btn_close"></a></div>
				</div>
				<ul class="popup_content">
					<li class="icon"></li>
					<li class="text NanumRound">
						<span>등록된 추가서류를 다시한번 확인하시고</span>
						<span>누락된 내용은 추가 업로드 바랍니다. </span>
					</li>
					<li class="dec NanumRound">
						<span>단, 근로자 입력기간(2019년 1월 25일)까지</span>
						<span>완료 하신 내용까지 반영됩니다. </span>
					</li>
				</ul>
			</div>
		</div>
	</div>
	
<script type="text/javascript">

	$(document).ready(function() {
		
		$(".btn_close").on("click", function(e){
			$(this).closest(".layerPop_wrap").addClass("hidden");
		});

		// 이전화면
		$(".btn_type.type1").on("click", function(){
			var url = rootPath + "html/easyFeb/e_easyYearTax_step03_default.html?d=" + (new Date()).getTime();
			
			$("#contents_wrap").empty();
		    $(window).off("resize");
		    $.ajax({
		        url : url, 
		        success : function(result) {
		            $("#contents_wrap").html(result);
		        }
		    });
		});


		// 다음화면
		$(".btn_type.type3").on("click", function(){
			//var url = rootPath + "html/easyFeb/e_easyYearTax_step05_01.html?d=" + (new Date()).getTime();
			//var url = "http://localhost:8080/app.html#/e_yearTax_basicsData_map_summary";
			var url = "/app.html#/e_yearTax_basicsData_map_summary";
			location.href = url;
			/*
			$("#contents_wrap").empty();
		    $(window).off("resize");
		    $.ajax({
		        url : url, 
		        success : function(result) {
		            $("#contents_wrap").html(result);
		        }
		    });
		    */
		});

		//**** 펼치기 event
		$( "input[type=checkbox]" ).on( "click", function(){
			var _target=$(this).attr("id");
			if($(this).is(":checked")){
				$('[class~="'+_target+'"]').addClass("show");
				
			}else{
				$('[class~="'+_target+'"]').removeClass("show");
			}
			console.log(_target)
		});

		getFileCount();
		
	});

	function getFileCount(){

		var contractId = getCookie('yearContractId');

		var url = rootPath + 'easyFeb/getFileCount.do'
		var params = {
			'계약ID': contractId
		};

		request = $.ajax({
			url: url,
	        type: "get",
	        cache: false,
	        dataType:"json",
	        data: params
	    });

		request.done(function(res){
			if ( res['success'] === true ) {
				var data = res.data;
				
				$("#교육비건수").text(data.교육비건수);
				$("#기부금건수").text(data.기부금건수);
				$("#기타영수증건수").text(data.기타영수증건수);
				$("#보험료건수").text(data.보험료건수);
				$("#부양가족건수").text(data.부양가족건수);
				$("#신용카드건수").text(data.신용카드건수);
				$("#월세액건수").text(data.월세액건수);
				$("#의료비건수").text(data.의료비건수);
				$("#종전근무지건수").text(data.종전근무지건수);
				$("#주택자금건수").text(data.주택자금건수);
			}
		});
		
		request.fail(function (request, textStatus, error) {
			if (request.status=="401") {
				alert("사용자 권한이 존재하지 않습니다.\r\n다시 접속하여 주시기 바랍니다.");
				location.href=rootPath;
			} else {
				alert("입력하신 정보를 다시 확인해주시기 바랍니다."+error);
		        //alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
			}
		});
	}
	
	function fn_addFile(공제구분코드) {
		
		//var 사용자ID = getParams().사용자ID;
		var 사용자ID = getCookie("userId");
		var url;
		if(공제구분코드 == 'F200'){	//보험료
			var url = rootPath + '/html/easyFeb/feb_popup_addDocInsurance.html?type=f&d=' + (new Date()).getTime();
		}else if(공제구분코드 == 'F600'){	//의료비
			var url = rootPath + '/html/easyFeb/feb_popup_addDocMedical.html?type=f&d=' + (new Date()).getTime();
		}else if(공제구분코드 == 'F800'){	//교육비
			var url = rootPath + '/html/easyFeb/feb_popup_addDocEducation.html?type=f&d=' + (new Date()).getTime();
		}else if(공제구분코드 == 'F500'){	//신용카드
			var url = rootPath + '/html/easyFeb/feb_popup_addDocCredit.html?type=f&d=' + (new Date()).getTime();
		}else if(공제구분코드 == 'F400'){	//월세공제
			var url = rootPath + '/html/easyFeb/feb_popup_addDocMonthlyRent.html?type=f&d=' + (new Date()).getTime();
		}else if(공제구분코드 == 'F700'){	//기부금
			var url = rootPath + '/html/easyFeb/feb_popup_addDocDonation.html?type=f&d=' + (new Date()).getTime();
		}else if(공제구분코드 == 'F300' || 공제구분코드 == 'F000' || 공제구분코드 == 'F900' || 공제구분코드 == 'F100'|| 공제구분코드 == 'FXXX'){	//주택자금공제, 기타공제, 종전근무지, 부양가족, 연금계좌
			var url = rootPath + '/html/easyFeb/feb_popup_addDoc.html?cd=' + 공제구분코드 + '&type=f&d=' + (new Date()).getTime();
		}
		
		//var url = rootPath + '/html/easyFeb/feb_popup_addDocSubmit_write.html?사용자ID=' + 사용자ID + '&공제구분코드=' + 공제구분코드 + '&openType=D' + '&d=' + (new Date()).getMilliseconds();;
		window.open(url, '추가제출서류 수정', 'width=1000, height=700, location=no, menubar=no, status=no, scrollbars=no, toolbar=no');
	}
	
	// open window
	function  openWin (url, name, width, height) {
	    if (typeof width === 'undefined' || width === 0) { width = screen.width - 20; }
	    if (typeof height === 'undefined' || height === 0) { height = screen.height - 100; }
	    window.open(url, name, 'width=' + width + ', height=' + height + ', location=no, menubar=no, status=no, scrollbars=no, toolbar=no');
	}
	
</script>

